<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Methods | Ovarian Cancer Histotypes: Report of Statistical Findings</title>
  <meta name="description" content="2 Methods | Ovarian Cancer Histotypes: Report of Statistical Findings" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Methods | Ovarian Cancer Histotypes: Report of Statistical Findings" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Methods | Ovarian Cancer Histotypes: Report of Statistical Findings" />
  
  
  

<meta name="author" content="Derek Chiu" />


<meta name="date" content="2020-11-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html"/>
<link rel="next" href="validation.html"/>
<script src="assets/jquery-2.2.3/jquery.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />












</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>2</b> Methods</a><ul>
<li class="chapter" data-level="2.1" data-path="methods.html"><a href="methods.html#data-processing"><i class="fa fa-check"></i><b>2.1</b> Data Processing</a><ul>
<li class="chapter" data-level="2.1.1" data-path="methods.html"><a href="methods.html#raw-data"><i class="fa fa-check"></i><b>2.1.1</b> Raw Data</a></li>
<li class="chapter" data-level="2.1.2" data-path="methods.html"><a href="methods.html#housekeeping-genes"><i class="fa fa-check"></i><b>2.1.2</b> Housekeeping Genes</a></li>
<li class="chapter" data-level="2.1.3" data-path="methods.html"><a href="methods.html#common-samples-and-genes"><i class="fa fa-check"></i><b>2.1.3</b> Common Samples and Genes</a></li>
<li class="chapter" data-level="2.1.4" data-path="methods.html"><a href="methods.html#cs1-training-set-generation"><i class="fa fa-check"></i><b>2.1.4</b> CS1 Training Set Generation</a></li>
<li class="chapter" data-level="2.1.5" data-path="methods.html"><a href="methods.html#cs2-training-set-generation"><i class="fa fa-check"></i><b>2.1.5</b> CS2 Training Set Generation</a></li>
<li class="chapter" data-level="2.1.6" data-path="methods.html"><a href="methods.html#cohort-distribution"><i class="fa fa-check"></i><b>2.1.6</b> Cohort Distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="methods.html"><a href="methods.html#normalization-between-codesets"><i class="fa fa-check"></i><b>2.2</b> Normalization Between CodeSets</a><ul>
<li class="chapter" data-level="2.2.1" data-path="methods.html"><a href="methods.html#common-samples-method"><i class="fa fa-check"></i><b>2.2.1</b> Common Samples Method</a></li>
<li class="chapter" data-level="2.2.2" data-path="methods.html"><a href="methods.html#pools-method"><i class="fa fa-check"></i><b>2.2.2</b> Pools Method</a></li>
<li class="chapter" data-level="2.2.3" data-path="methods.html"><a href="methods.html#concordance-comparison"><i class="fa fa-check"></i><b>2.2.3</b> Concordance Comparison</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="methods.html"><a href="methods.html#histotype-classification"><i class="fa fa-check"></i><b>2.3</b> Histotype Classification</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="validation.html"><a href="validation.html"><i class="fa fa-check"></i><b>3</b> Validation</a><ul>
<li class="chapter" data-level="3.1" data-path="validation.html"><a href="validation.html#full-data-distributions"><i class="fa fa-check"></i><b>3.1</b> Full Data Distributions</a></li>
<li class="chapter" data-level="3.2" data-path="validation.html"><a href="validation.html#training-set-distributions"><i class="fa fa-check"></i><b>3.2</b> Training Set Distributions</a></li>
<li class="chapter" data-level="3.3" data-path="validation.html"><a href="validation.html#normalization"><i class="fa fa-check"></i><b>3.3</b> Normalization</a><ul>
<li class="chapter" data-level="3.3.1" data-path="validation.html"><a href="validation.html#common-samples-method-1"><i class="fa fa-check"></i><b>3.3.1</b> Common Samples Method</a></li>
<li class="chapter" data-level="3.3.2" data-path="validation.html"><a href="validation.html#pools-method-1"><i class="fa fa-check"></i><b>3.3.2</b> Pools Method</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="validation.html"><a href="validation.html#common-sample-distributions"><i class="fa fa-check"></i><b>3.4</b> Common Sample Distributions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>4</b> Results</a><ul>
<li class="chapter" data-level="4.1" data-path="results.html"><a href="results.html#cs1"><i class="fa fa-check"></i><b>4.1</b> CS1</a><ul>
<li class="chapter" data-level="4.1.1" data-path="results.html"><a href="results.html#accuracy"><i class="fa fa-check"></i><b>4.1.1</b> Accuracy</a></li>
<li class="chapter" data-level="4.1.2" data-path="results.html"><a href="results.html#f1-score"><i class="fa fa-check"></i><b>4.1.2</b> F1-Score</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="results.html"><a href="results.html#cs2"><i class="fa fa-check"></i><b>4.2</b> CS2</a><ul>
<li class="chapter" data-level="4.2.1" data-path="results.html"><a href="results.html#accuracy-1"><i class="fa fa-check"></i><b>4.2.1</b> Accuracy</a></li>
<li class="chapter" data-level="4.2.2" data-path="results.html"><a href="results.html#f1-score-1"><i class="fa fa-check"></i><b>4.2.2</b> F1-Score</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Ovarian Cancer Histotypes: Report of Statistical Findings</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="methods" class="section level1">
<h1><span class="header-section-number">2</span> Methods</h1>
<div id="data-processing" class="section level2">
<h2><span class="header-section-number">2.1</span> Data Processing</h2>
<p>RNA was extracted from FFPE ovarian carcinoma samples and expression was quantified using NanoString nCounter. Samples were run in three CodeSets. Some samples or pools of samples were repeated across CodeSets for expression normalization. Normalizing CS2 to CS3 can easily follow the <a href="https://dchiu911.shinyapps.io/PrOType/">PrOType</a> method for HGSC subtypes because both CodeSets have pool samples. A different technique is implemented when normalizing across CS1, CS2, and CS3 where we use common samples and genes as reference sets.</p>
<div id="raw-data" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Raw Data</h3>
<p>NanoString CodeSets contained a mix of all probes of interest, six positive controls spiked-in at fixed proportional concentrations (0.125- 128 fM), and eight negative controls (probes without a corresponding target). Gene targets also included 5 housekeeping genes: POLR1B, SDHA, PGK1, ACTB, RPL19. Gene selection was made from top ranked differential gene expression analysis between ovarian cancer histotypes and molecular subtypes of HGSC, as well as containing some genes of interest from unrelated projects. Gene targets in each subsequent CodeSet were re-curated, where non-informative genes were dropped and new potential differentiating genes were added.</p>
<p>There are 3 NanoString CodeSets:</p>
<ul>
<li>CS1: OvCa2103_C953
<ul>
<li>Samples = 412</li>
<li>Genes = 275</li>
</ul></li>
<li>CS2: PrOTYPE2_v2_C1645
<ul>
<li>Samples = 1223</li>
<li>Genes = 384</li>
</ul></li>
<li>CS3: OTTA2014_C2822
<ul>
<li>Samples = 5424</li>
<li>Genes = 532</li>
</ul></li>
</ul>
<p>These datasets contain raw counts extracted straight from NanoString RCC files.</p>
</div>
<div id="housekeeping-genes" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Housekeeping Genes</h3>
<p>The first normalization step is to normalize all endogenous genes to housekeeping genes (POLR1B, SDHA, PGK1, ACTB, RPL19; reference genes expressed in all cells). We normalize by subtracting the average log<sub>2</sub> housekeeping gene expression from the log<sub>2</sub> endogenous gene expression.</p>
<p><code>log2(endogenous expression) - log2⁡(average housekeeping expression) = relative expression</code></p>
<p>The updated CodeSet dimensions are now:</p>
<ul>
<li>CS1: OvCa2103_C953
<ul>
<li>Samples = 412</li>
<li>Genes = 256</li>
</ul></li>
<li>CS2: PrOTYPE2_v2_C1645
<ul>
<li>Samples = 1223</li>
<li>Genes = 365</li>
</ul></li>
<li>CS3: OTTA2014_C2822
<ul>
<li>Samples = 5424</li>
<li>Genes = 513</li>
</ul></li>
</ul>
<p>The number of genes are reduced by 19: 5 housekeeping, 8 negative, 6 positive (the latter 2 types are not used).</p>
</div>
<div id="common-samples-and-genes" class="section level3">
<h3><span class="header-section-number">2.1.3</span> Common Samples and Genes</h3>
<p>Since the reference pool samples only exist in CS2 and CS3, we need to find an alternative method to normalize all three CodeSets. One method is to select common samples and common genes that exist in all three. We found 72 common genes. Using the <code>summaryID</code> identifier, we also found 78 common summary IDs, translating to 320 samples. The number of samples that were matched to each CodeSet differed:</p>
<ul>
<li>CS1: OvCa2103_C953
<ul>
<li>Samples = 93</li>
<li>Genes = 72</li>
</ul></li>
<li>CS2: PrOTYPE2_v2_C1645
<ul>
<li>Samples = 87</li>
<li>Genes = 72</li>
</ul></li>
<li>CS3: OTTA2014_C2822
<ul>
<li>Samples = 140</li>
<li>Genes = 72</li>
</ul></li>
</ul>
<div id="overlap-of-common-samples-by-summary-id" class="section level4">
<h4><span class="header-section-number">2.1.3.1</span> Overlap of common samples by summary ID</h4>
<p><img src="OV_Histotypes_RSF_files/figure-html/venn-id-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="overlap-of-common-genes" class="section level4">
<h4><span class="header-section-number">2.1.3.2</span> Overlap of common genes</h4>
<p><img src="OV_Histotypes_RSF_files/figure-html/venn-genes-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>*Excluding housekeeping genes and controls</p>
</div>
</div>
<div id="cs1-training-set-generation" class="section level3">
<h3><span class="header-section-number">2.1.4</span> CS1 Training Set Generation</h3>
<p>We use the reference method to normalize CS1 to CS3.</p>
<ul>
<li>CS1 reference set: duplicate samples from CS1
<ul>
<li>Samples = 25</li>
<li>Genes = 72</li>
</ul></li>
<li>CS3 reference set: corresponding samples in CS3 also found in CS1 reference set
<ul>
<li>Samples = 20</li>
<li>Genes = 72</li>
</ul></li>
<li>CS1 validation set: remaining CS1 samples with reference set removed
<ul>
<li>Samples = 387</li>
<li>Genes = 72</li>
</ul></li>
</ul>
<p>The final CS1 training set has 304 samples on 72 genes after normalization and keeping only the major histotypes of interest.</p>
</div>
<div id="cs2-training-set-generation" class="section level3">
<h3><span class="header-section-number">2.1.5</span> CS2 Training Set Generation</h3>
<p>We use the pool method to normalize CS2 to CS3 so we can be consistent with the PrOType normalization when there are available pools.</p>
<ul>
<li>CS2 pools:
<ul>
<li>Samples = 12 (Pool 1 = 4, Pool 2 = 4, Pool 3 = 4)</li>
<li>Genes = 365</li>
</ul></li>
<li>CS3 pools:
<ul>
<li>Samples = 22 (Pool 1 = 12, Pool 2 = 5, Pool 3 = 5)</li>
<li>Genes = 513</li>
</ul></li>
<li>CS2 validation set: CS2 samples with pools removed
<ul>
<li>Samples = 1214</li>
<li>Genes = 365</li>
</ul></li>
</ul>
<p>The final CS2 training set has 945 samples on 136 (common) genes after normalization and keeping only the major histotypes of interest.</p>
</div>
<div id="cohort-distribution" class="section level3">
<h3><span class="header-section-number">2.1.6</span> Cohort Distribution</h3>
<p>CodeSets comprised samples from sites collected internationally as shown below. Note that the CS3 pools sample total (n=58) shown here include those that are not used as reference pools, following previous normalization methods. In particular, the distribution of CS3 pools actually used for normalization (n=22) is POOL1 = 12, POOL2 = 5, POOL3 = 5.</p>
<table>
<caption><span id="tab:cohort-dist">Table 2.1: </span>Cohort Distribution amongst CodeSets</caption>
<thead>
<tr class="header">
<th align="left">cohort</th>
<th align="right">cs1</th>
<th align="right">cs2</th>
<th align="right">cs3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">MAYO</td>
<td align="right">6</td>
<td align="right">63</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">MTL</td>
<td align="right">3</td>
<td align="right">59</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">OOU</td>
<td align="right">108</td>
<td align="right">43</td>
<td align="right">19</td>
</tr>
<tr class="even">
<td align="left">OOUE</td>
<td align="right">32</td>
<td align="right">30</td>
<td align="right">11</td>
</tr>
<tr class="odd">
<td align="left">VOA</td>
<td align="right">145</td>
<td align="right">122</td>
<td align="right">538</td>
</tr>
<tr class="even">
<td align="left">ICON7</td>
<td align="right">NA</td>
<td align="right">416</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">JAPAN</td>
<td align="right">NA</td>
<td align="right">8</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">OVAR3</td>
<td align="right">NA</td>
<td align="right">150</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">POOL-CTRL</td>
<td align="right">NA</td>
<td align="right">12</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">DOVE4</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1160</td>
</tr>
<tr class="odd">
<td align="left">POOL-1</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">31</td>
</tr>
<tr class="even">
<td align="left">POOL-2</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="left">POOL-3</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="left">TNCO</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">691</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="normalization-between-codesets" class="section level2">
<h2><span class="header-section-number">2.2</span> Normalization Between CodeSets</h2>
<p>After normalization to housekeeping genes and filtering for the five major histotypes of interest, as determined by pathology review and/or IHC, two methods were used to normalize data between CodeSets.</p>
<div id="common-samples-method" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Common Samples Method</h3>
<p>The common samples method was used to normalize CodeSet1, 2, and 3, where common samples and genes were used as reference sets. Among the samples repeated in all CodeSets we normalized using either: a random set of 3 samples from each major histotype (random3; n=15), a random set of 2 samples from each major histotype (random2; n=10), or a random set of 1 sample from each major histotype (random1; n=5). In each case CodeSet3 expression (<code>X^3</code>) was held fixed, while CodeSet1/2 expression (<code>X^1</code> and <code>X^2</code>) were normalized to CodeSet3 by subtracting the average gene expression from the CodeSet1/2 reference set (<code>R^1</code> or <code>R^2</code>) and adding the average gene expression of the CodeSet3 reference set (<code>R^3</code>). Alternatively, <code>X^1(norm) = X^1 - R^1 + R^3</code> would calibrate CodeSet1 to CodeSet3.</p>
</div>
<div id="pools-method" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Pools Method</h3>
<p>The pools method was used to normalize CodeSet2 and CodeSet3. The three reference pools, regularly assayed mixes of samples representing all histotypes, were run in CodeSet2 and CodeSet3 only. CodeSet2 contained 12 reference pool samples (Pool 1 = 4, Pool 2 = 4, Pool 3 = 4) and CodeSet3 contained 22 reference pool samples (Pool 1 = 12, Pool 2 = 5, Pool 3 = 5). Similar to the common samples method, CodeSet2 was normalized to CodeSet3 via: <code>X^2(norm) = X^2 - R^2 + R^3</code> where R is the average expression of the reference pool samples in the respective CodeSet. This method of pool normalization was also used by PrOType to classify HGSC subtypes</p>
</div>
<div id="concordance-comparison" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Concordance Comparison</h3>
<p>Concordance between CodeSets using the different normalization strategies was compared in common samples, excluding those used for the normalization, using Pearson’s correlation coefficient (<code>R2</code>), coefficient of accuracy (<code>Ca</code>), and Lin’s concordance correlation (<code>Rc= R2⋅Ca</code>).</p>
</div>
</div>
<div id="histotype-classification" class="section level2">
<h2><span class="header-section-number">2.3</span> Histotype Classification</h2>
<p>We use 6 classification algorithms and 4 subsampling methods across 500 repetitions in the supervised learning framework for CS1 and CS2. The pipeline was run using many SGE batch jobs as a way of parallelization on a CentOS 5 server. Implementations of the techniques below were called from the <a href="https://alinetalhouk.github.io/splendid/">splendid</a> package.</p>
<ul>
<li>Classifiers:
<ul>
<li>Random Forest</li>
<li>Adaboost</li>
<li>XGBoost</li>
<li>LDA</li>
<li>SVM</li>
<li>K-Nearest Neighbours</li>
</ul></li>
<li>Subsampling:
<ul>
<li>None</li>
<li>Down-sampling</li>
<li>Up-sampling</li>
<li>SMOTE</li>
</ul></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="validation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["OV_Histotypes_RSF.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
