% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames*,x11names*}{xcolor}
%
\documentclass[
]{report}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Ovarian Cancer Histotypes: Report of Statistical Findings},
  pdfauthor={Derek Chiu},
  colorlinks=true,
  linkcolor=Maroon,
  filecolor=Maroon,
  citecolor=Blue,
  urlcolor=Blue,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{longtable,booktabs}
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{titlesec, blindtext, color}

\titleformat{\chapter}[display]
  {\Huge\bfseries}
  {}
  {0pt}
  {\thechapter.\ }

\titleformat{name=\chapter,numberless}[display]
  {\Huge\bfseries}
  {}
  {0pt}
  {}

\titlespacing*{\chapter}{0pt}{0pt}{40pt}

\renewcommand{\bibname}{References}
\usepackage[]{natbib}
\bibliographystyle{apalike}

\title{Ovarian Cancer Histotypes: Report of Statistical Findings}
\author{Derek Chiu}
\date{2020-01-07}

\begin{document}
\maketitle

{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{1}
\tableofcontents
}
\listoftables
\listoffigures
\hypertarget{preface}{%
\chapter*{Preface}\label{preface}}
\addcontentsline{toc}{chapter}{Preface}

This report of statistical findings describes the classification of ovarian cancer histotypes using data from NanoString CodeSets.

Marina Pavanello conducted the initial exploratory data analysis, Cathy Tang implemented class imbalance techniques, Derek Chiu conducted the normalization and statistical analysis, and Aline Talhouk lead the project.

\hypertarget{introduction}{%
\chapter{Introduction}\label{introduction}}

Ovarian cancer has five major histotypes: high-grade serous carcinoma (HGSC), low-grade serous carcinoma (LGSC), endometrioid carcinoma (ENOC), mucinous carcinoma (MUC), and clear cell carcinoma (CCOC). A common problem with classifying these histotypes is that there is a class imbalance issue. HGSC dominates the distribution, commonly accounting for 70\% of cases in many patient cohorts, while the other four histotypes are spread over the rest.

In the NanoString CodeSets, we also run into a problem with trying to find suitable control pools to normalize the gene expression. For prospective NanoString runs, the pools can be specifically chosen, but for retrospective runs, we have to utilize a combination of common samples and common genes as references for normalization.

The supervised learning is performed under a consensus framework: we consider various classification algorithms and use evaluation metrics to help making decisions of which methods to carry forward.

\hypertarget{methods}{%
\chapter{Methods}\label{methods}}

\hypertarget{data-processing}{%
\section{Data Processing}\label{data-processing}}

Normalizing CS2 to CS3 can easily follow the PrOTYPE method for HGSC subtypes because both CodeSets have pool samples. A different technique is implemented when normalizing CS1 to CS3 where we use common samples and genes as reference sets.

\hypertarget{raw-data}{%
\subsection{Raw Data}\label{raw-data}}

There are 3 NanoString CodeSets:

\begin{itemize}
\tightlist
\item
  CS1: OvCa2103\_C953

  \begin{itemize}
  \tightlist
  \item
    Samples = 412
  \item
    Genes = 275
  \end{itemize}
\item
  CS2: PrOTYPE2\_v2\_C1645

  \begin{itemize}
  \tightlist
  \item
    Samples = 1223
  \item
    Genes = 384
  \end{itemize}
\item
  CS3: OTTA2014\_C2822

  \begin{itemize}
  \tightlist
  \item
    Samples = 5424
  \item
    Genes = 532
  \end{itemize}
\end{itemize}

These datasets contain raw counts extracted straight from NanoString RCC files.

\hypertarget{housekeeping-genes}{%
\subsection{Housekeeping Genes}\label{housekeeping-genes}}

The first normalization step is to normalize all endogenous genes to housekeeping genes (POLR1B, SDHA, PGK1, ACTB, RPL19; reference genes expressed in all cells). We normalize by subtracting the average log2 housekeeping gene expression from the log2 endogenous gene expression. The updated CodeSet dimensions are now:

\begin{itemize}
\tightlist
\item
  CS1: OvCa2103\_C953

  \begin{itemize}
  \tightlist
  \item
    Samples = 412
  \item
    Genes = 256
  \end{itemize}
\item
  CS2: PrOTYPE2\_v2\_C1645

  \begin{itemize}
  \tightlist
  \item
    Samples = 1223
  \item
    Genes = 365
  \end{itemize}
\item
  CS3: OTTA2014\_C2822

  \begin{itemize}
  \tightlist
  \item
    Samples = 5424
  \item
    Genes = 513
  \end{itemize}
\end{itemize}

The number of genes are reduced by 19: 5 housekeeping, 8 negative, 6 positive (the latter 2 types are not used).

\hypertarget{common-samples-and-genes}{%
\subsection{Common Samples and Genes}\label{common-samples-and-genes}}

Since the reference pool samples only exist in CS2 and CS3, we need to find an alternative method to normalize all three CodeSets. One method is to select common samples and common genes that exist in all three. We found 72 common genes. Using the \texttt{summaryID} identifer, we found 78 common summary IDs, which translated to 320 samples. The number of samples that were found in each CodeSet differed:

\begin{itemize}
\tightlist
\item
  CS1: OvCa2103\_C953

  \begin{itemize}
  \tightlist
  \item
    Samples = 93
  \item
    Genes = 72
  \end{itemize}
\item
  CS2: PrOTYPE2\_v2\_C1645

  \begin{itemize}
  \tightlist
  \item
    Samples = 87
  \item
    Genes = 72
  \end{itemize}
\item
  CS3: OTTA2014\_C2822

  \begin{itemize}
  \tightlist
  \item
    Samples = 140
  \item
    Genes = 72
  \end{itemize}
\end{itemize}

\hypertarget{cs1-training-set-generation}{%
\subsection{CS1 Training Set Generation}\label{cs1-training-set-generation}}

We use the reference method to normalize CS1 to CS3.

\begin{itemize}
\tightlist
\item
  CS1 reference set: duplicate samples from CS1

  \begin{itemize}
  \tightlist
  \item
    Samples = 25
  \item
    Genes = 72
  \end{itemize}
\item
  CS3 reference set: corresponding samples in CS3 also found in CS1 reference set

  \begin{itemize}
  \tightlist
  \item
    Samples = 20
  \item
    Genes = 72
  \end{itemize}
\item
  CS1 validation set: remaining CS1 samples with reference set removed

  \begin{itemize}
  \tightlist
  \item
    Samples = 387
  \item
    Genes = 72
  \end{itemize}
\end{itemize}

The final CS1 training set has 304 samples on 72 genes after normalization and keeping only the major histotypes of interest.

\hypertarget{cs2-training-set-generation}{%
\subsection{CS2 Training Set Generation}\label{cs2-training-set-generation}}

We use the pool method to normalize CS2 to CS3 so we can be consistent with the PrOTYPE normalization when there are available pools.

\begin{itemize}
\tightlist
\item
  CS3 pools:

  \begin{itemize}
  \tightlist
  \item
    Samples = 22
  \item
    Genes = 513
  \end{itemize}
\item
  CS2 pools:

  \begin{itemize}
  \tightlist
  \item
    Samples = 10
  \item
    Genes = 365
  \end{itemize}
\end{itemize}

The final CS2 training set has 945 samples on 136 (common) genes after normalization
and keeping ony the major histotypes of interest.

\hypertarget{classification}{%
\section{Classification}\label{classification}}

We use 5 classification algorithms and 4 subsampling methods across 500 repetitions in the supervised learning framework for CS1.

\begin{itemize}
\tightlist
\item
  Classifiers:

  \begin{itemize}
  \tightlist
  \item
    Random Forest
  \item
    Adaboost
  \item
    LDA
  \item
    SVM
  \item
    K-Nearest Neighbours
  \end{itemize}
\item
  Subsampling:

  \begin{itemize}
  \tightlist
  \item
    None
  \item
    Down-sampling
  \item
    Up-sampling
  \item
    SMOTE
  \end{itemize}
\end{itemize}

\hypertarget{validation}{%
\chapter{Validation}\label{validation}}

First we'd like to validate the CS2 normalization process.

\begin{figure}

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/cs2-none-vs-cs3-1} 

}

\caption{Gene Expression CS2 No Normalization vs. CS3}\label{fig:cs2-none-vs-cs3}
\end{figure}

\begin{figure}

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/cs2-pools-vs-cs3-1} 

}

\caption{Gene Expression CS2 Pools Normalization vs. CS3}\label{fig:cs2-pools-vs-cs3}
\end{figure}

\begin{figure}

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/cs2-reference-vs-cs3-1} 

}

\caption{Gene Expression CS2 Reference Normalization vs. CS3}\label{fig:cs2-reference-vs-cs3}
\end{figure}

\begin{figure}

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/cc-hist-1} 

}

\caption{Concordance Histograms}\label{fig:cc-hist}
\end{figure}

\begin{table}

\caption{\label{tab:dist-all-gr}All CodeSet Histotype Groups}
\centering
\begin{tabular}[t]{l|r|r|r}
\hline
hist\_gr & CS1 & CS2 & CS3\\
\hline
HGSC & 169 & 757 & 2453\\
\hline
non-HGSC & 196 & 377 & 677\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:dist-all}All CodeSet Histotypes}
\centering
\begin{tabular}[t]{l|r|r|r}
\hline
revHist & CS1 & CS2 & CS3\\
\hline
CARCINOMA-NOS & 0 & 61 & 23\\
\hline
Carcinoma, NOS & 0 & 0 & 2\\
\hline
CCC & 57 & 0 & 182\\
\hline
CCOC & 0 & 68 & 0\\
\hline
CCOC-MCT & 0 & 1 & 0\\
\hline
Cell-Line & 17 & 48 & 13\\
\hline
CTRL & 0 & 12 & 0\\
\hline
ENOC & 0 & 30 & 0\\
\hline
ENOC-CCOC & 0 & 7 & 0\\
\hline
ENOCa & 61 & 0 & 272\\
\hline
ERROR & 0 & 3 & 0\\
\hline
HGSC & 169 & 757 & 2453\\
\hline
HGSC-MCT & 0 & 1 & 0\\
\hline
LGSC & 22 & 29 & 50\\
\hline
MBOT & 0 & 20 & 3\\
\hline
MET-NOP & 0 & 21 & 0\\
\hline
MIXED (ENOC/CCOC) & 0 & 0 & 1\\
\hline
MIXED (ENOC/LGSC) & 0 & 0 & 1\\
\hline
MIXED (HGSC/CCOC) & 0 & 0 & 1\\
\hline
mixed cell & 0 & 0 & 7\\
\hline
MMMT & 0 & 0 & 30\\
\hline
MUC & 20 & 61 & 77\\
\hline
Other (use when 6, 7, or 9 is not distinguished) or unknown if epithelial & 0 & 0 & 1\\
\hline
Other/Exclude & 0 & 0 & 8\\
\hline
SBOT & 19 & 10 & 3\\
\hline
Serous & 0 & 0 & 2\\
\hline
serous LMP & 0 & 0 & 1\\
\hline
SQAMOUS & 0 & 1 & 0\\
\hline
UNK & 0 & 4 & 0\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:dist-cs1}CS1 Histotypes}
\centering
\begin{tabular}[t]{l|l|r}
\hline
CodeSet & revHist & n\\
\hline
CS1 & CCC & 57\\
\hline
CS1 & Cell-Line & 17\\
\hline
CS1 & ENOCa & 61\\
\hline
CS1 & HGSC & 169\\
\hline
CS1 & LGSC & 22\\
\hline
CS1 & MUC & 20\\
\hline
CS1 & SBOT & 19\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:dist-cs2}CS2 Histotypes}
\centering
\begin{tabular}[t]{l|l|r}
\hline
CodeSet & revHist & n\\
\hline
CS2 & CARCINOMA-NOS & 61\\
\hline
CS2 & CCOC & 68\\
\hline
CS2 & CCOC-MCT & 1\\
\hline
CS2 & Cell-Line & 48\\
\hline
CS2 & CTRL & 12\\
\hline
CS2 & ENOC & 30\\
\hline
CS2 & ENOC-CCOC & 7\\
\hline
CS2 & ERROR & 3\\
\hline
CS2 & HGSC & 757\\
\hline
CS2 & HGSC-MCT & 1\\
\hline
CS2 & LGSC & 29\\
\hline
CS2 & MBOT & 20\\
\hline
CS2 & MET-NOP & 21\\
\hline
CS2 & MUC & 61\\
\hline
CS2 & SBOT & 10\\
\hline
CS2 & SQAMOUS & 1\\
\hline
CS2 & UNK & 4\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:dist-cs3}CS3 Histotypes}
\centering
\begin{tabular}[t]{l|l|r}
\hline
CodeSet & revHist & n\\
\hline
CS3 & CARCINOMA-NOS & 23\\
\hline
CS3 & Carcinoma, NOS & 2\\
\hline
CS3 & CCC & 182\\
\hline
CS3 & Cell-Line & 13\\
\hline
CS3 & ENOCa & 272\\
\hline
CS3 & HGSC & 2453\\
\hline
CS3 & LGSC & 50\\
\hline
CS3 & MBOT & 3\\
\hline
CS3 & MIXED (ENOC/CCOC) & 1\\
\hline
CS3 & MIXED (ENOC/LGSC) & 1\\
\hline
CS3 & MIXED (HGSC/CCOC) & 1\\
\hline
CS3 & mixed cell & 7\\
\hline
CS3 & MMMT & 30\\
\hline
CS3 & MUC & 77\\
\hline
CS3 & Other (use when 6, 7, or 9 is not distinguished) or unknown if epithelial & 1\\
\hline
CS3 & Other/Exclude & 8\\
\hline
CS3 & SBOT & 3\\
\hline
CS3 & Serous & 2\\
\hline
CS3 & serous LMP & 1\\
\hline
\end{tabular}
\end{table}

\hypertarget{results}{%
\chapter{Results}\label{results}}

  \bibliography{packages.bib}

\end{document}
