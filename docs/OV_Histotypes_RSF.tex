% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
]{report}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{titlesec, blindtext, color, float}

\titleformat{\chapter}[display]
  {\Huge\bfseries}
  {}
  {0pt}
  {\thechapter.\ }

\titleformat{name=\chapter,numberless}[display]
  {\Huge\bfseries}
  {}
  {0pt}
  {}

\titlespacing*{\chapter}{0pt}{0pt}{40pt}

\renewcommand{\bibname}{References}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{apalike}
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Ovarian Cancer Histotypes: Report of Statistical Findings},
  pdfauthor={Derek Chiu},
  colorlinks=true,
  linkcolor={Maroon},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}

\title{Ovarian Cancer Histotypes: Report of Statistical Findings}
\author{Derek Chiu}
\date{2023-03-13}

\begin{document}
\maketitle

{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{1}
\tableofcontents
}
\listoffigures
\listoftables
\hypertarget{preface}{%
\chapter*{Preface}\label{preface}}
\addcontentsline{toc}{chapter}{Preface}

This report of statistical findings describes the classification of ovarian cancer histotypes using data from NanoString CodeSets.

Marina Pavanello conducted the initial exploratory data analysis, Cathy Tang implemented class imbalance techniques, Derek Chiu conducted the normalization and statistical analysis, and Lauren Tindale and Aline Talhouk are the project leads.

\hypertarget{introduction}{%
\chapter{Introduction}\label{introduction}}

Ovarian cancer has five major histotypes: high-grade serous carcinoma (HGSC), low-grade serous carcinoma (LGSC), endometrioid carcinoma (ENOC), mucinous carcinoma (MUC), and clear cell carcinoma (CCOC). A common problem with classifying these histotypes is that there is a class imbalance issue. HGSC dominates the distribution, commonly accounting for 70\% of cases in many patient cohorts, while the other four histotypes are spread over the rest of the cases. Subsampling methods like up-sampling, down-sampling, and SMOTE can be used to mitigate this problem.

The supervised learning is performed under a consensus framework: we consider various classification algorithms and use evaluation metrics like accuracy, F1-score, Kappa, and G-mean to inform the decision of which methods to carry forward for prediction in confirmation and validation sets.

\hypertarget{methods}{%
\chapter{Methods}\label{methods}}

We use 5 classification algorithms and 4 subsampling methods across 500 repetitions in the supervised learning framework for the Training Set, CS1 and CS2. The pipeline was run using SLURM batch jobs submitted to a partition on a CentOS 7 server. Implementations of the techniques below were called from the \href{https://alinetalhouk.github.io/splendid/}{splendid} package.

\begin{itemize}
\item
  Classifiers:

  \begin{itemize}
  \tightlist
  \item
    Random Forest
  \item
    SVM
  \item
    Adaboost
  \item
    Multinomial Regression Model with Ridge Penalty
  \item
    Multinomial Regression Model with LASSO Penalty
  \end{itemize}
\item
  Subsampling:

  \begin{itemize}
  \tightlist
  \item
    None
  \item
    Down-sampling
  \item
    Up-sampling
  \item
    SMOTE
  \end{itemize}
\end{itemize}

\hypertarget{distributions}{%
\chapter{Distributions}\label{distributions}}

\hypertarget{full-data}{%
\section{Full Data}\label{full-data}}

The histotype distributions on the full data are shown below.

\begin{table}

\caption{\label{tab:dist-all-hist-gr}All CodeSet Histotype Groups}
\centering
\begin{tabular}[t]{l|r|r|r}
\hline
Histotype Group & CS1 & CS2 & CS3\\
\hline
HGSC & 123 & 645 & 1645\\
\hline
non-HGSC & 166 & 220 & 585\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:dist-major-hist}All CodeSet Major Reviewed Histotypes}
\centering
\begin{tabular}[t]{l|r|r|r|r|r|r}
\hline
Reviewed Histotype & CS1 & CS2 & CS3 & CS1 \% & CS2 \% & CS3 \%\\
\hline
CCOC & 48 & 61 & 175 & 17.8 & 7.4 & 8.1\\
\hline
ENOC & 60 & 32 & 232 & 22.2 & 3.9 & 10.7\\
\hline
HGSC & 123 & 645 & 1645 & 45.6 & 78.6 & 76.1\\
\hline
LGSC & 20 & 21 & 40 & 7.4 & 2.6 & 1.9\\
\hline
MUC & 19 & 62 & 69 & 7.0 & 7.6 & 3.2\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:dist-all}All CodeSet Reviewed Histotypes}
\centering
\begin{tabular}[t]{l|r|r|r}
\hline
Reviewed Histotype & CS1 & CS2 & CS3\\
\hline
CARCINOMA-NOS & 0 & 1 & 23\\
\hline
CCOC & 48 & 61 & 175\\
\hline
CTRL & 0 & 12 & 0\\
\hline
ENOC & 60 & 32 & 232\\
\hline
HGSC & 123 & 645 & 1645\\
\hline
LGSC & 20 & 21 & 40\\
\hline
MBOT & 0 & 19 & 3\\
\hline
MIXED (ENOC/CCOC) & 0 & 0 & 1\\
\hline
MIXED (ENOC/LGSC) & 0 & 0 & 1\\
\hline
MIXED (HGSC/CCOC) & 0 & 0 & 1\\
\hline
MMMT & 0 & 0 & 29\\
\hline
MUC & 19 & 62 & 69\\
\hline
Other/Exclude & 0 & 0 & 8\\
\hline
SBOT & 19 & 12 & 2\\
\hline
serous LMP & 0 & 0 & 1\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:dist-cs1}CS1 Histotypes}
\centering
\begin{tabular}[t]{l|l|r}
\hline
CodeSet & Reviewed Histotype & n\\
\hline
CS1 & CCOC & 48\\
\hline
CS1 & ENOC & 60\\
\hline
CS1 & HGSC & 123\\
\hline
CS1 & LGSC & 20\\
\hline
CS1 & MUC & 19\\
\hline
CS1 & SBOT & 19\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:dist-cs2}CS2 Histotypes}
\centering
\begin{tabular}[t]{l|l|r}
\hline
CodeSet & Reviewed Histotype & n\\
\hline
CS2 & CARCINOMA-NOS & 1\\
\hline
CS2 & CCOC & 61\\
\hline
CS2 & CTRL & 12\\
\hline
CS2 & ENOC & 32\\
\hline
CS2 & HGSC & 645\\
\hline
CS2 & LGSC & 21\\
\hline
CS2 & MBOT & 19\\
\hline
CS2 & MUC & 62\\
\hline
CS2 & SBOT & 12\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:dist-cs3}CS3 Histotypes}
\centering
\begin{tabular}[t]{l|l|r}
\hline
CodeSet & Reviewed Histotype & n\\
\hline
CS3 & CARCINOMA-NOS & 23\\
\hline
CS3 & CCOC & 175\\
\hline
CS3 & ENOC & 232\\
\hline
CS3 & HGSC & 1645\\
\hline
CS3 & LGSC & 40\\
\hline
CS3 & MBOT & 3\\
\hline
CS3 & MIXED (ENOC/CCOC) & 1\\
\hline
CS3 & MIXED (ENOC/LGSC) & 1\\
\hline
CS3 & MIXED (HGSC/CCOC) & 1\\
\hline
CS3 & MMMT & 29\\
\hline
CS3 & MUC & 69\\
\hline
CS3 & Other/Exclude & 8\\
\hline
CS3 & SBOT & 2\\
\hline
CS3 & serous LMP & 1\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:dist-common}Common Summary ID CodeSet Histotypes}
\centering
\begin{tabular}[t]{l|r|r|r}
\hline
Reviewed Histotype & CS1 & CS2 & CS3\\
\hline
CCOC & 3 & 4 & 9\\
\hline
ENOC & 4 & 4 & 9\\
\hline
HGSC & 57 & 62 & 94\\
\hline
LGSC & 7 & 5 & 8\\
\hline
MUC & 7 & 5 & 11\\
\hline
\end{tabular}
\end{table}

\hypertarget{training-sets}{%
\section{Training Sets}\label{training-sets}}

\hypertarget{cs1-training-set-generation}{%
\subsection{CS1 Training Set Generation}\label{cs1-training-set-generation}}

We use the reference method to normalize CS1 to CS3.

\begin{itemize}
\item
  CS1 reference set: duplicate samples from CS1

  \begin{itemize}
  \tightlist
  \item
    Samples = 16
  \item
    Genes = 72
  \end{itemize}
\item
  CS3 reference set: corresponding samples in CS3 also found in CS1 reference set

  \begin{itemize}
  \tightlist
  \item
    Samples = 9
  \item
    Genes = 72
  \end{itemize}
\item
  CS1 validation set: remaining CS1 samples with reference set removed

  \begin{itemize}
  \tightlist
  \item
    Samples = 273
  \item
    Genes = 72
  \end{itemize}
\end{itemize}

The final CS1 training set has 254 samples on 72 genes after normalization and keeping only the major histotypes of interest.

\begin{table}

\caption{\label{tab:training-dist-cs1}CS1 Training Set Histotypes}
\centering
\begin{tabular}[t]{l|r|l}
\hline
Histotype & n & \%\\
\hline
CCC & 57 & 18.8\%\\
\hline
ENOCa & 59 & 19.4\%\\
\hline
HGSC & 156 & 51.3\%\\
\hline
LGSC & 16 & 5.3\%\\
\hline
MUC & 16 & 5.3\%\\
\hline
\end{tabular}
\end{table}

\hypertarget{cs2-training-set-generation}{%
\subsection{CS2 Training Set Generation}\label{cs2-training-set-generation}}

We use the pool method to normalize CS2 to CS3 so we can be consistent with the PrOType normalization when there are available pools.

\begin{itemize}
\item
  CS2 pools:

  \begin{itemize}
  \tightlist
  \item
    Samples = 12 (Pool 1 = 4, Pool 2 = 4, Pool 3 = 4)
  \item
    Genes = 365
  \end{itemize}
\item
  CS3 pools:

  \begin{itemize}
  \tightlist
  \item
    Samples = 22 (Pool 1 = 12, Pool 2 = 5, Pool 3 = 5)
  \item
    Genes = 513
  \end{itemize}
\item
  CS2 validation set: CS2 samples with pools removed

  \begin{itemize}
  \tightlist
  \item
    Samples = 881
  \item
    Genes = 365
  \end{itemize}
\end{itemize}

The final CS2 training set has 821 samples on 136 (common) genes after normalization and keeping only the major histotypes of interest.

\begin{table}

\caption{\label{tab:training-dist-cs2}CS2 Training Set Histotypes}
\centering
\begin{tabular}[t]{l|r|l}
\hline
Histotype & n & \%\\
\hline
CCOC & 68 & 7.2\%\\
\hline
ENOC & 30 & 3.2\%\\
\hline
HGSC & 757 & 80.1\%\\
\hline
LGSC & 29 & 3.1\%\\
\hline
MUC & 61 & 6.5\%\\
\hline
\end{tabular}
\end{table}

\hypertarget{common-samples}{%
\section{Common Samples}\label{common-samples}}

\begin{table}

\caption{\label{tab:common-dist-all}All Common Samples Histotype Distribution}
\centering
\begin{tabular}[t]{l|r|r|r}
\hline
revHist & CS1 & CS2 & CS3\\
\hline
CCOC & 3 & 4 & 3\\
\hline
ENOC & 4 & 4 & 3\\
\hline
HGSC & 55 & 58 & 70\\
\hline
LGSC & 7 & 5 & 4\\
\hline
MUC & 7 & 5 & 5\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:common-dist-distinct}Distinct Common Samples Histotype Distribution}
\centering
\begin{tabular}[t]{l|r|r|r}
\hline
revHist & CS1 & CS2 & CS3\\
\hline
CCOC & 3 & 3 & 3\\
\hline
ENOC & 3 & 3 & 3\\
\hline
HGSC & 53 & 53 & 53\\
\hline
LGSC & 4 & 4 & 4\\
\hline
MUC & 5 & 5 & 5\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:common-cs2-cs3-dist-distinct}Distinct Common CS2 and CS3 Samples Histotype Distribution}
\centering
\begin{tabular}[t]{l|r|r}
\hline
revHist & CS2 & CS3\\
\hline
CCOC & 3 & 3\\
\hline
ENOC & 3 & 3\\
\hline
HGSC & 71 & 71\\
\hline
LGSC & 4 & 4\\
\hline
MUC & 5 & 5\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:common-dist-sites}Common Samples Across Sites Histotype Distribution}
\centering
\begin{tabular}[t]{l|r|r|r}
\hline
revHist & AOC & USC & Vancouver\\
\hline
CCOC & 3 & 3 & 3\\
\hline
ENOC & 3 & 3 & 3\\
\hline
HGSC & 13 & 13 & 26\\
\hline
LGSC & 2 & 2 & 2\\
\hline
MUC & 3 & 3 & 3\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:common-dist-sites-distinct}Distinct Common Samples Across Sites Histotype Distribution}
\centering
\begin{tabular}[t]{l|r|r|r}
\hline
revHist & AOC & USC & Vancouver\\
\hline
CCOC & 3 & 3 & 3\\
\hline
ENOC & 3 & 3 & 3\\
\hline
HGSC & 13 & 13 & 13\\
\hline
LGSC & 2 & 2 & 2\\
\hline
MUC & 3 & 3 & 3\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:cs345-overlap}CS3/CS4/CS5 Common Samples Histotype Distribution}
\centering
\begin{tabular}[t]{l|r|r|r}
\hline
revHist & CS3 & CS4 & CS5\\
\hline
HGSC & 47 & 47 & 47\\
\hline
NA & 26 & 26 & 26\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:cs345-pools}CS3/CS4/CS5 Pools Distribution}
\centering
\begin{tabular}[t]{l|r|r|r}
\hline
Pool & CS3 & CS4 & CS5\\
\hline
Pool1 & 12 & 5 & 4\\
\hline
Pool2 & 5 & 5 & 4\\
\hline
Pool3 & 5 & 5 & 4\\
\hline
Pool4 & NA & 2 & 1\\
\hline
Pool5 & NA & 2 & 1\\
\hline
Pool6 & NA & 2 & 0\\
\hline
Pool7 & NA & 2 & 1\\
\hline
Pool8 & NA & 2 & 1\\
\hline
Pool9 & NA & 2 & 1\\
\hline
Pool10 & NA & 2 & 1\\
\hline
Pool11 & NA & 2 & 1\\
\hline
\end{tabular}
\end{table}

\hypertarget{histotypes-in-classifier-data}{%
\section{Histotypes in Classifier Data}\label{histotypes-in-classifier-data}}

\begin{table}

\caption{\label{tab:train-hist-codeset}Full Training Set Histotype Distribution by CodeSet}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
Variable & Levels & CS1 & CS2 & CS3 & Total\\
\hline
Histotype & HGSC & 119 (48\%) & 624 (80\%) & 475 (94\%) & 1218 (79\%)\\
\hline
 & CCOC & 44 (18\%) & 54 (7\%) & 8 (2\%) & 106 (7\%)\\
\hline
 & ENOC & 55 (22\%) & 27 (3\%) & 8 (2\%) & 90 (6\%)\\
\hline
 & MUC & 15 (6\%) & 59 (8\%) & 9 (2\%) & 83 (5\%)\\
\hline
 & LGSC & 14 (6\%) & 19 (2\%) & 6 (1\%) & 39 (3\%)\\
\hline
Total & N (\%) & 247 (16\%) & 783 (51\%) & 506 (33\%) & 1536 (100\%)\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:hist-codeset-dataset}Histotype Distribution by CodeSet/Datasets}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
Variable & Levels & CS1 All & CS2 All & Confirmation & Validation\\
\hline
Histotype & HGSC & 122 (46\%) & 644 (79\%) & 422 (66\%) & 676 (74\%)\\
\hline
 & CCOC & 47 (18\%) & 60 (7\%) & 75 (12\%) & 81 (9\%)\\
\hline
 & ENOC & 58 (22\%) & 30 (4\%) & 106 (16\%) & 108 (12\%)\\
\hline
 & MUC & 18 (7\%) & 61 (7\%) & 27 (4\%) & 26 (3\%)\\
\hline
 & LGSC & 18 (7\%) & 20 (2\%) & 13 (2\%) & 18 (2\%)\\
\hline
Total & N (\%) & 263 (10\%) & 815 (31\%) & 643 (24\%) & 909 (35\%)\\
\hline
\end{tabular}
\end{table}

\hypertarget{results}{%
\chapter{Results}\label{results}}

We show internal validation summaries for the combined classifier training set, as well as the CS1 and CS2 sets with duplicates included. The F1-scores, kappa, and G-mean are the measures of interest. Algorithms are sorted by descending value based on the overallaccuracy of the training set. The point ranges show the median, 5th and 95th percentiles, coloured by subsampling methods.

\hypertarget{training-set}{%
\section{Training Set}\label{training-set}}

\hypertarget{accuracy}{%
\subsection{Accuracy}\label{accuracy}}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-accuracy-1} 

}

\caption{Training Set Accuracy}\label{fig:train-accuracy}
\end{figure}

\begin{table}

\caption{\label{tab:train-accuracy-table}Training Set Accuracy by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
sampling & rf & svm & adaboost & mlr\_ridge & mlr\_lasso\\
\hline
none & 0.936 & 0.94 & 0.925 & 0.936 & 0.934\\
\hline
up & 0.941 & 0.937 & 0.943 & 0.901 & 0.908\\
\hline
down & 0.878 & 0.87 & 0.869 & 0.857 & 0.836\\
\hline
smote & \textbf{0.944} & 0.935 & 0.935 & 0.915 & 0.911\\
\hline
\end{tabular}
\end{table}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-accuracy-class-1} 

}

\caption{Training Set Class-Specific Accuracy}\label{fig:train-accuracy-class}
\end{figure}

\begin{table}

\caption{\label{tab:train-accuracy-class-table}Training Set Class-Specific Accuracy by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l|l}
\hline
sampling & histotype & rf & svm & adaboost & mlr\_ridge & mlr\_lasso\\
\hline
none & CCOC & 0.984 & 0.981 & 0.982 & 0.984 & 0.982\\
\hline
none & ENOC & 0.973 & 0.975 & 0.971 & 0.973 & 0.971\\
\hline
none & HGSC & 0.949 & 0.953 & 0.936 & 0.951 & 0.953\\
\hline
none & LGSC & 0.98 & 0.984 & 0.976 & 0.977 & 0.979\\
\hline
none & MUC & 0.986 & 0.986 & 0.986 & \textbf{0.988} & 0.985\\
\hline
up & CCOC & 0.984 & 0.979 & 0.984 & 0.978 & 0.972\\
\hline
up & ENOC & 0.976 & 0.973 & 0.973 & 0.955 & 0.955\\
\hline
up & HGSC & 0.953 & 0.952 & 0.962 & 0.921 & 0.934\\
\hline
up & LGSC & 0.982 & 0.987 & 0.985 & 0.963 & 0.976\\
\hline
up & MUC & 0.987 & 0.984 & 0.984 & 0.984 & 0.981\\
\hline
down & CCOC & 0.979 & 0.968 & 0.977 & 0.976 & 0.971\\
\hline
down & ENOC & 0.949 & 0.948 & 0.946 & 0.944 & 0.942\\
\hline
down & HGSC & 0.9 & 0.896 & 0.895 & 0.881 & 0.864\\
\hline
down & LGSC & 0.953 & 0.96 & 0.953 & 0.937 & 0.926\\
\hline
down & MUC & 0.977 & 0.977 & 0.972 & 0.982 & 0.976\\
\hline
smote & CCOC & 0.983 & 0.978 & 0.982 & 0.979 & 0.976\\
\hline
smote & ENOC & 0.973 & 0.972 & 0.968 & 0.964 & 0.958\\
\hline
smote & HGSC & 0.963 & 0.95 & 0.956 & 0.935 & 0.934\\
\hline
smote & LGSC & 0.986 & 0.986 & 0.984 & 0.968 & 0.971\\
\hline
smote & MUC & 0.984 & 0.985 & 0.981 & 0.986 & 0.983\\
\hline
\end{tabular}
\end{table}

\hypertarget{f1-score}{%
\subsection{F1-Score}\label{f1-score}}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-f1-1} 

}

\caption{Training Set F1-Score}\label{fig:train-f1}
\end{figure}

\begin{table}

\caption{\label{tab:train-f1-table}Training Set Macro-Averaged F1-Score by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
sampling & rf & svm & adaboost & mlr\_ridge & mlr\_lasso\\
\hline
none & 0.762 & 0.823 & 0.728 & 0.769 & 0.781\\
\hline
up & 0.802 & 0.823 & 0.826 & 0.775 & 0.767\\
\hline
down & 0.742 & 0.73 & 0.725 & 0.727 & 0.694\\
\hline
smote & \textbf{0.835} & 0.823 & 0.818 & 0.791 & 0.779\\
\hline
\end{tabular}
\end{table}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-f1-class-1} 

}

\caption{Training Set Class-Specific F1-Score}\label{fig:train-f1-class}
\end{figure}

\begin{table}

\caption{\label{tab:train-f1-class-table}Training Set Class-Specific F1-Score by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l|l}
\hline
sampling & histotype & rf & svm & adaboost & mlr\_ridge & mlr\_lasso\\
\hline
none & CCOC & 0.875 & 0.857 & 0.862 & 0.871 & 0.865\\
\hline
none & ENOC & 0.733 & 0.776 & 0.702 & 0.758 & 0.734\\
\hline
none & HGSC & 0.969 & 0.971 & 0.961 & 0.97 & 0.971\\
\hline
none & LGSC & 0.375 & 0.667 & 0.167 & 0.37 & 0.483\\
\hline
none & MUC & 0.873 & 0.857 & 0.857 & 0.885 & 0.862\\
\hline
up & CCOC & 0.873 & 0.836 & 0.873 & 0.846 & 0.8\\
\hline
up & ENOC & 0.776 & 0.754 & 0.765 & 0.675 & 0.646\\
\hline
up & HGSC & 0.971 & 0.971 & 0.976 & 0.948 & 0.958\\
\hline
up & LGSC & 0.526 & 0.72 & 0.667 & 0.545 & 0.615\\
\hline
up & MUC & 0.877 & 0.846 & 0.857 & 0.862 & 0.821\\
\hline
down & CCOC & 0.849 & 0.781 & 0.837 & 0.829 & 0.805\\
\hline
down & ENOC & 0.645 & 0.639 & 0.617 & 0.625 & 0.602\\
\hline
down & HGSC & 0.934 & 0.931 & 0.929 & 0.92 & 0.907\\
\hline
down & LGSC & 0.481 & 0.519 & 0.473 & 0.418 & 0.377\\
\hline
down & MUC & 0.8 & 0.8 & 0.771 & 0.841 & 0.785\\
\hline
smote & CCOC & 0.873 & 0.831 & 0.865 & 0.85 & 0.83\\
\hline
smote & ENOC & 0.769 & 0.762 & 0.732 & 0.716 & 0.676\\
\hline
smote & HGSC & \textbf{0.977} & 0.969 & 0.972 & 0.959 & 0.957\\
\hline
smote & LGSC & 0.714 & 0.71 & 0.692 & 0.571 & 0.588\\
\hline
smote & MUC & 0.849 & 0.851 & 0.833 & 0.868 & 0.847\\
\hline
\end{tabular}
\end{table}

\hypertarget{kappa}{%
\subsection{Kappa}\label{kappa}}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-kappa-1} 

}

\caption{Training Set Kappa}\label{fig:train-kappa}
\end{figure}

\begin{table}

\caption{\label{tab:train-kappa-table}Training Set Kappa by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
sampling & rf & svm & adaboost & mlr\_ridge & mlr\_lasso\\
\hline
none & 0.804 & 0.824 & 0.76 & 0.81 & 0.81\\
\hline
up & 0.821 & 0.814 & 0.838 & 0.754 & 0.757\\
\hline
down & 0.71 & 0.694 & 0.691 & 0.677 & 0.638\\
\hline
smote & \textbf{0.843} & 0.816 & 0.821 & 0.782 & 0.769\\
\hline
\end{tabular}
\end{table}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-kappa-class-1} 

}

\caption{Training Set Class-Specific Kappa}\label{fig:train-kappa-class}
\end{figure}

\begin{table}

\caption{\label{tab:train-kappa-class-table}Training Set Class-Specific Kappa by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l|l}
\hline
sampling & histotype & rf & svm & adaboost & mlr\_ridge & mlr\_lasso\\
\hline
none & CCOC & 0.868 & 0.846 & 0.853 & 0.862 & 0.855\\
\hline
none & ENOC & 0.719 & 0.763 & 0.686 & 0.743 & 0.718\\
\hline
none & HGSC & 0.832 & 0.854 & 0.781 & 0.843 & 0.853\\
\hline
none & LGSC & 0.368 & 0.659 & 0.122 & 0.357 & 0.469\\
\hline
none & MUC & 0.866 & 0.849 & 0.849 & 0.879 & 0.853\\
\hline
up & CCOC & 0.865 & 0.824 & 0.864 & 0.835 & 0.784\\
\hline
up & ENOC & 0.764 & 0.738 & 0.75 & 0.649 & 0.623\\
\hline
up & HGSC & 0.846 & 0.845 & 0.881 & 0.784 & 0.806\\
\hline
up & LGSC & 0.518 & 0.713 & 0.66 & 0.529 & 0.602\\
\hline
up & MUC & 0.871 & 0.839 & 0.849 & 0.853 & 0.812\\
\hline
down & CCOC & 0.838 & 0.763 & 0.824 & 0.817 & 0.79\\
\hline
down & ENOC & 0.617 & 0.614 & 0.589 & 0.598 & 0.571\\
\hline
down & HGSC & 0.734 & 0.723 & 0.724 & 0.695 & 0.659\\
\hline
down & LGSC & 0.46 & 0.502 & 0.452 & 0.394 & 0.35\\
\hline
down & MUC & 0.787 & 0.79 & 0.756 & 0.83 & 0.772\\
\hline
smote & CCOC & 0.865 & 0.82 & 0.855 & 0.838 & 0.817\\
\hline
smote & ENOC & 0.756 & 0.746 & 0.714 & 0.695 & 0.655\\
\hline
smote & HGSC & \textbf{0.89} & 0.846 & 0.867 & 0.818 & 0.81\\
\hline
smote & LGSC & 0.707 & 0.702 & 0.685 & 0.558 & 0.576\\
\hline
smote & MUC & 0.839 & 0.844 & 0.822 & 0.861 & 0.839\\
\hline
\end{tabular}
\end{table}

\hypertarget{g-mean}{%
\subsection{G-mean}\label{g-mean}}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-gmean-1} 

}

\caption{Training Set G-mean}\label{fig:train-gmean}
\end{figure}

\begin{table}

\caption{\label{tab:train-gmean-table}Training Set G-mean by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
sampling & rf & svm & adaboost & mlr\_ridge & mlr\_lasso\\
\hline
none & 0.638 & 0.785 & 0.474 & 0.667 & 0.721\\
\hline
up & 0.714 & 0.77 & 0.802 & \textbf{0.87} & 0.803\\
\hline
down & 0.859 & 0.848 & 0.845 & 0.861 & 0.837\\
\hline
smote & 0.838 & 0.803 & 0.835 & 0.864 & 0.839\\
\hline
\end{tabular}
\end{table}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-gmean-class-1} 

}

\caption{Training Set Class-Specific G-mean}\label{fig:train-gmean-class}
\end{figure}

\begin{table}

\caption{\label{tab:train-gmean-class-table}Training Set Class-Specific G-mean by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l|l}
\hline
sampling & histotype & rf & svm & adaboost & mlr\_ridge & mlr\_lasso\\
\hline
none & CCOC & 0.909 & 0.9 & 0.893 & 0.906 & 0.914\\
\hline
none & ENOC & 0.804 & 0.853 & 0.763 & 0.839 & 0.829\\
\hline
none & HGSC & 0.877 & 0.907 & 0.835 & 0.894 & 0.908\\
\hline
none & LGSC & 0.485 & 0.794 & 0.258 & 0.516 & 0.639\\
\hline
none & MUC & 0.924 & 0.901 & 0.899 & 0.931 & 0.921\\
\hline
up & CCOC & 0.903 & 0.875 & 0.913 & 0.928 & 0.895\\
\hline
up & ENOC & 0.834 & 0.832 & 0.866 & 0.878 & 0.83\\
\hline
up & HGSC & 0.889 & 0.893 & 0.932 & 0.935 & 0.921\\
\hline
up & LGSC & 0.623 & 0.814 & 0.78 & 0.935 & 0.865\\
\hline
up & MUC & 0.923 & 0.886 & 0.932 & 0.94 & 0.905\\
\hline
down & CCOC & 0.927 & 0.91 & 0.921 & 0.921 & 0.917\\
\hline
down & ENOC & 0.878 & 0.877 & 0.858 & 0.877 & 0.858\\
\hline
down & HGSC & 0.922 & 0.916 & 0.917 & 0.91 & 0.899\\
\hline
down & LGSC & 0.915 & 0.92 & 0.912 & 0.931 & 0.912\\
\hline
down & MUC & 0.926 & 0.916 & 0.926 & 0.932 & 0.913\\
\hline
smote & CCOC & 0.929 & 0.891 & 0.921 & 0.927 & 0.921\\
\hline
smote & ENOC & 0.875 & 0.867 & 0.861 & 0.874 & 0.857\\
\hline
smote & HGSC & \textbf{0.947} & 0.912 & 0.943 & 0.939 & 0.933\\
\hline
smote & LGSC & 0.847 & 0.848 & 0.864 & 0.922 & 0.895\\
\hline
smote & MUC & 0.93 & 0.9 & 0.93 & 0.935 & 0.925\\
\hline
\end{tabular}
\end{table}

\hypertarget{two-step-training-set}{%
\section{Two-Step Training Set}\label{two-step-training-set}}

\hypertarget{accuracy-1}{%
\subsection{Accuracy}\label{accuracy-1}}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-step1-accuracy-1} 

}

\caption{Training Set Step 1 Accuracy}\label{fig:train-step1-accuracy}
\end{figure}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-step2-accuracy-1} 

}

\caption{Training Set Step 2 Accuracy}\label{fig:train-step2-accuracy}
\end{figure}

\begin{table}

\caption{\label{tab:train-step1-accuracy-table}Training Set Step 1 Accuracy by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
sampling & rf & svm & adaboost & mlr\_ridge & mlr\_lasso\\
\hline
none & \textbf{0.96} & 0.957 & 0.953 & 0.949 & 0.948\\
\hline
up & 0.959 & 0.957 & 0.959 & 0.94 & 0.938\\
\hline
down & 0.944 & 0.943 & 0.944 & 0.937 & 0.932\\
\hline
smote & 0.958 & 0.956 & 0.955 & 0.946 & 0.944\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:train-step2-accuracy-table}Training Set Step 2 Accuracy by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
sampling & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & 0.884 & 0.882 & 0.881 & 0.876 & 0.872\\
\hline
up & \textbf{0.886} & 0.881 & 0.878 & 0.874 & 0.87\\
\hline
down & 0.868 & 0.868 & 0.868 & 0.861 & 0.854\\
\hline
smote & 0.88 & 0.877 & 0.875 & 0.871 & 0.87\\
\hline
\end{tabular}
\end{table}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-step1-accuracy-class-1} 

}

\caption{Training Set Step 1 Class-Specific Accuracy}\label{fig:train-step1-accuracy-class}
\end{figure}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-step2-accuracy-class-1} 

}

\caption{Training Set Step 2 Class-Specific Accuracy}\label{fig:train-step2-accuracy-class}
\end{figure}

\begin{table}

\caption{\label{tab:train-step1-accuracy-class-table}Training Set Step 1 Class-Specific Accuracy by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l|l}
\hline
sampling & histotype & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & HGSC & \textbf{0.96} & 0.957 & 0.949 & 0.953 & 0.948\\
\hline
none & non-HGSC & \textbf{0.96} & 0.957 & 0.949 & 0.953 & 0.948\\
\hline
up & HGSC & 0.959 & 0.957 & 0.94 & 0.959 & 0.938\\
\hline
up & non-HGSC & 0.959 & 0.957 & 0.94 & 0.959 & 0.938\\
\hline
down & HGSC & 0.944 & 0.943 & 0.937 & 0.944 & 0.932\\
\hline
down & non-HGSC & 0.944 & 0.943 & 0.937 & 0.944 & 0.932\\
\hline
smote & HGSC & 0.958 & 0.956 & 0.946 & 0.955 & 0.944\\
\hline
smote & non-HGSC & 0.958 & 0.956 & 0.946 & 0.955 & 0.944\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:train-step2-accuracy-class-table}Training Set Step 2 Class-Specific Accuracy by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l|l}
\hline
sampling & histotype & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & CCOC & 0.951 & 0.93 & 0.934 & 0.943 & 0.934\\
\hline
none & ENOC & 0.906 & 0.915 & 0.904 & 0.899 & 0.9\\
\hline
none & LGSC & 0.967 & \textbf{0.982} & 0.974 & 0.974 & 0.966\\
\hline
none & MUC & 0.944 & 0.941 & 0.955 & 0.941 & 0.944\\
\hline
up & CCOC & 0.95 & 0.928 & 0.931 & 0.942 & 0.933\\
\hline
up & ENOC & 0.909 & 0.915 & 0.905 & 0.901 & 0.901\\
\hline
up & LGSC & 0.967 & \textbf{0.982} & 0.966 & 0.967 & 0.966\\
\hline
up & MUC & 0.946 & 0.94 & 0.951 & 0.939 & 0.941\\
\hline
down & CCOC & 0.94 & 0.921 & 0.931 & 0.935 & 0.933\\
\hline
down & ENOC & 0.899 & 0.902 & 0.901 & 0.89 & 0.894\\
\hline
down & LGSC & 0.966 & 0.976 & 0.961 & 0.965 & 0.957\\
\hline
down & MUC & 0.933 & 0.935 & 0.948 & 0.93 & 0.926\\
\hline
smote & CCOC & 0.948 & 0.927 & 0.932 & 0.942 & 0.936\\
\hline
smote & ENOC & 0.908 & 0.913 & 0.904 & 0.899 & 0.901\\
\hline
smote & LGSC & 0.967 & \textbf{0.982} & 0.966 & 0.968 & 0.965\\
\hline
smote & MUC & 0.942 & 0.938 & 0.95 & 0.931 & 0.939\\
\hline
\end{tabular}
\end{table}

\hypertarget{f1-score-1}{%
\subsection{F1-Score}\label{f1-score-1}}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-step1-f1-1} 

}

\caption{Training Set Step 1 F1-Score}\label{fig:train-step1-f1}
\end{figure}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-step2-f1-1} 

}

\caption{Training Set Step 2 F1-Score}\label{fig:train-step2-f1}
\end{figure}

\begin{table}

\caption{\label{tab:train-step1-f1-table}Training Set Step 1 Macro-Averaged F1-Score by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
sampling & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & \textbf{0.975} & 0.973 & 0.968 & 0.971 & 0.967\\
\hline
up & \textbf{0.975} & 0.973 & 0.962 & 0.974 & 0.96\\
\hline
down & 0.964 & 0.963 & 0.959 & 0.964 & 0.956\\
\hline
smote & 0.974 & 0.972 & 0.966 & 0.971 & 0.965\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:train-step2-f1-table}Training Set Step 2 Macro-Averaged F1-Score by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
sampling & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & 0.882 & \textbf{0.885} & 0.88 & 0.877 & 0.87\\
\hline
up & 0.883 & 0.884 & 0.876 & 0.873 & 0.868\\
\hline
down & 0.866 & 0.873 & 0.866 & 0.859 & 0.85\\
\hline
smote & 0.879 & 0.881 & 0.874 & 0.869 & 0.866\\
\hline
\end{tabular}
\end{table}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-step1-f1-class-1} 

}

\caption{Training Set Step 1 Class-Specific F1-Score}\label{fig:train-step1-f1-class}
\end{figure}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-step2-f1-class-1} 

}

\caption{Training Set Step 2 Class-Specific F1-Score}\label{fig:train-step2-f1-class}
\end{figure}

\begin{center}\includegraphics{OV_Histotypes_RSF_files/figure-latex/train-step1-f1-class-table-1} \end{center}

\begin{center}\includegraphics{OV_Histotypes_RSF_files/figure-latex/train-step2-f1-class-table-1} \end{center}

\hypertarget{kappa-1}{%
\subsection{Kappa}\label{kappa-1}}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-step1-kappa-1} 

}

\caption{Training Set Step 1 Kappa}\label{fig:train-step1-kappa}
\end{figure}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-step2-kappa-1} 

}

\caption{Training Set Step 2 Kappa}\label{fig:train-step2-kappa}
\end{figure}

\begin{table}

\caption{\label{tab:train-step1-kappa-table}Training Set Step 1 Kappa by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
sampling & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & \textbf{0.873} & 0.868 & 0.84 & 0.847 & 0.836\\
\hline
up & 0.872 & 0.868 & 0.827 & 0.872 & 0.818\\
\hline
down & 0.838 & 0.835 & 0.817 & 0.837 & 0.806\\
\hline
smote & 0.872 & 0.865 & 0.839 & 0.861 & 0.834\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:train-step2-kappa-table}Training Set Step 2 Kappa by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
sampling & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & 0.841 & 0.836 & 0.836 & 0.829 & 0.824\\
\hline
up & \textbf{0.842} & 0.836 & 0.832 & 0.827 & 0.821\\
\hline
down & 0.818 & 0.819 & 0.82 & 0.808 & 0.801\\
\hline
smote & 0.835 & 0.831 & 0.827 & 0.822 & 0.82\\
\hline
\end{tabular}
\end{table}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-step1-kappa-class-1} 

}

\caption{Training Set Step 1 Class-Specific Kappa}\label{fig:train-step1-kappa-class}
\end{figure}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-step2-kappa-class-1} 

}

\caption{Training Set Step 2 Class-Specific Kappa}\label{fig:train-step2-kappa-class}
\end{figure}

\begin{table}

\caption{\label{tab:train-step1-kappa-class-table}Training Set Step 1 Class-Specific Kappa by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l|l}
\hline
sampling & histotype & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & HGSC & \textbf{0.873} & 0.868 & 0.84 & 0.847 & 0.836\\
\hline
none & non-HGSC & \textbf{0.873} & 0.868 & 0.84 & 0.847 & 0.836\\
\hline
up & HGSC & 0.872 & 0.868 & 0.827 & 0.872 & 0.818\\
\hline
up & non-HGSC & 0.872 & 0.868 & 0.827 & 0.872 & 0.818\\
\hline
down & HGSC & 0.838 & 0.835 & 0.817 & 0.837 & 0.806\\
\hline
down & non-HGSC & 0.838 & 0.835 & 0.817 & 0.837 & 0.806\\
\hline
smote & HGSC & 0.872 & 0.865 & 0.839 & 0.861 & 0.834\\
\hline
smote & non-HGSC & 0.872 & 0.865 & 0.839 & 0.861 & 0.834\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:train-step2-kappa-class-table}Training Set Step 2 Class-Specific Kappa by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l|l}
\hline
sampling & histotype & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & CCOC & 0.89 & 0.841 & 0.851 & 0.872 & 0.85\\
\hline
none & ENOC & 0.772 & 0.794 & 0.765 & 0.753 & 0.755\\
\hline
none & LGSC & 0.857 & \textbf{0.903} & 0.874 & 0.874 & 0.847\\
\hline
none & MUC & 0.855 & 0.846 & 0.882 & 0.847 & 0.858\\
\hline
up & CCOC & 0.888 & 0.838 & 0.841 & 0.866 & 0.849\\
\hline
up & ENOC & 0.778 & 0.792 & 0.767 & 0.76 & 0.754\\
\hline
up & LGSC & 0.856 & 0.9 & 0.851 & 0.855 & 0.84\\
\hline
up & MUC & 0.857 & 0.843 & 0.876 & 0.84 & 0.853\\
\hline
down & CCOC & 0.865 & 0.821 & 0.84 & 0.852 & 0.848\\
\hline
down & ENOC & 0.751 & 0.76 & 0.757 & 0.728 & 0.737\\
\hline
down & LGSC & 0.847 & 0.899 & 0.831 & 0.845 & 0.814\\
\hline
down & MUC & 0.824 & 0.83 & 0.865 & 0.823 & 0.806\\
\hline
smote & CCOC & 0.881 & 0.834 & 0.843 & 0.867 & 0.854\\
\hline
smote & ENOC & 0.773 & 0.789 & 0.765 & 0.755 & 0.757\\
\hline
smote & LGSC & 0.855 & 0.9 & 0.846 & 0.863 & 0.841\\
\hline
smote & MUC & 0.849 & 0.835 & 0.874 & 0.824 & 0.84\\
\hline
\end{tabular}
\end{table}

\hypertarget{g-mean-1}{%
\subsection{G-mean}\label{g-mean-1}}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-step1-gmean-1} 

}

\caption{Training Set Step 1 G-mean}\label{fig:train-step1-gmean}
\end{figure}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-step2-gmean-1} 

}

\caption{Training Set Step 2 G-mean}\label{fig:train-step2-gmean}
\end{figure}

\begin{table}

\caption{\label{tab:train-step1-gmean-table}Training Set Step 1 G-mean by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
sampling & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & 0.917 & 0.928 & 0.906 & 0.896 & 0.905\\
\hline
up & 0.918 & 0.921 & 0.93 & 0.929 & 0.926\\
\hline
down & 0.937 & \textbf{0.939} & 0.93 & 0.935 & 0.927\\
\hline
smote & 0.932 & 0.929 & 0.923 & 0.926 & 0.923\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:train-step2-gmean-table}Training Set Step 2 G-mean by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
sampling & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & 0.885 & 0.882 & 0.883 & 0.877 & 0.869\\
\hline
up & \textbf{0.887} & 0.881 & 0.882 & 0.878 & 0.874\\
\hline
down & 0.874 & 0.874 & 0.877 & 0.865 & 0.859\\
\hline
smote & 0.885 & 0.88 & 0.881 & 0.875 & 0.871\\
\hline
\end{tabular}
\end{table}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-step1-gmean-class-1} 

}

\caption{Training Set Step 1 Class-Specific G-mean}\label{fig:train-step1-gmean-class}
\end{figure}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/train-step2-gmean-class-1} 

}

\caption{Training Set Step 2 Class-Specific G-mean}\label{fig:train-step2-gmean-class}
\end{figure}

\begin{table}

\caption{\label{tab:train-step1-gmean-class-table}Training Set Step 1 Class-Specific G-mean by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l|l}
\hline
sampling & histotype & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & HGSC & 0.917 & 0.928 & 0.906 & 0.896 & 0.905\\
\hline
none & non-HGSC & 0.917 & 0.928 & 0.906 & 0.896 & 0.905\\
\hline
up & HGSC & 0.918 & 0.921 & 0.93 & 0.929 & 0.926\\
\hline
up & non-HGSC & 0.918 & 0.921 & 0.93 & 0.929 & 0.926\\
\hline
down & HGSC & 0.937 & \textbf{0.939} & 0.93 & 0.935 & 0.927\\
\hline
down & non-HGSC & 0.937 & \textbf{0.939} & 0.93 & 0.935 & 0.927\\
\hline
smote & HGSC & 0.932 & 0.929 & 0.923 & 0.926 & 0.923\\
\hline
smote & non-HGSC & 0.932 & 0.929 & 0.923 & 0.926 & 0.923\\
\hline
\end{tabular}
\end{table}

\begin{table}

\caption{\label{tab:train-step2-gmean-class-table}Training Set Step 2 Class-Specific G-mean by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l|l}
\hline
sampling & histotype & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & CCOC & 0.942 & 0.922 & 0.922 & 0.932 & 0.924\\
\hline
none & ENOC & 0.891 & 0.895 & 0.887 & 0.884 & 0.876\\
\hline
none & LGSC & 0.946 & 0.953 & 0.94 & 0.942 & 0.922\\
\hline
none & MUC & 0.924 & 0.92 & 0.94 & 0.92 & 0.934\\
\hline
up & CCOC & 0.941 & 0.922 & 0.916 & 0.927 & 0.92\\
\hline
up & ENOC & 0.893 & 0.896 & 0.886 & 0.885 & 0.874\\
\hline
up & LGSC & 0.948 & 0.952 & 0.951 & 0.941 & 0.942\\
\hline
up & MUC & 0.924 & 0.917 & 0.936 & 0.919 & 0.929\\
\hline
down & CCOC & 0.927 & 0.909 & 0.912 & 0.92 & 0.918\\
\hline
down & ENOC & 0.873 & 0.881 & 0.881 & 0.861 & 0.864\\
\hline
down & LGSC & 0.949 & \textbf{0.957} & 0.951 & 0.948 & 0.943\\
\hline
down & MUC & 0.91 & 0.91 & 0.926 & 0.915 & 0.904\\
\hline
smote & CCOC & 0.935 & 0.916 & 0.914 & 0.924 & 0.921\\
\hline
smote & ENOC & 0.892 & 0.899 & 0.885 & 0.882 & 0.876\\
\hline
smote & LGSC & 0.949 & 0.953 & 0.949 & 0.947 & 0.943\\
\hline
smote & MUC & 0.922 & 0.916 & 0.935 & 0.915 & 0.923\\
\hline
\end{tabular}
\end{table}

\hypertarget{cs1-set}{%
\section{CS1 Set}\label{cs1-set}}

\hypertarget{accuracy-2}{%
\subsection{Accuracy}\label{accuracy-2}}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/cs1-accuracy-1} 

}

\caption{CS1 Set Accuracy}\label{fig:cs1-accuracy}
\end{figure}

\begin{table}

\caption{\label{tab:cs1-accuracy-table}CS1 Set Accuracy by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
sampling & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & 0.828 & \textbf{0.849} & 0.841 & 0.808 & 0.831\\
\hline
up & 0.847 & 0.841 & 0.842 & 0.835 & 0.824\\
\hline
down & 0.802 & 0.811 & 0.788 & 0.781 & 0.766\\
\hline
smote & 0.846 & 0.841 & 0.837 & 0.839 & 0.823\\
\hline
\end{tabular}
\end{table}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/cs1-accuracy-class-1} 

}

\caption{CS1 Set Class-Specific Accuracy}\label{fig:cs1-accuracy-class}
\end{figure}

\begin{table}

\caption{\label{tab:cs1-accuracy-class-table}CS1 Set Class-Specific Accuracy by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l|l}
\hline
sampling & histotype & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & CCOC & 0.942 & 0.944 & 0.938 & 0.941 & 0.937\\
\hline
none & ENOC & 0.891 & 0.912 & 0.898 & 0.887 & 0.897\\
\hline
none & HGSC & 0.902 & 0.903 & 0.912 & 0.882 & 0.904\\
\hline
none & LGSC & 0.956 & 0.972 & 0.968 & 0.947 & 0.957\\
\hline
none & MUC & 0.969 & 0.969 & 0.977 & 0.967 & 0.97\\
\hline
up & CCOC & 0.945 & 0.937 & 0.933 & 0.941 & 0.922\\
\hline
up & ENOC & 0.901 & 0.904 & 0.896 & 0.892 & 0.884\\
\hline
up & HGSC & 0.918 & 0.899 & 0.916 & 0.906 & 0.911\\
\hline
up & LGSC & 0.968 & \textbf{0.978} & 0.967 & 0.965 & 0.961\\
\hline
up & MUC & 0.971 & 0.969 & 0.971 & 0.969 & 0.977\\
\hline
down & CCOC & 0.939 & 0.936 & 0.941 & 0.933 & 0.926\\
\hline
down & ENOC & 0.881 & 0.888 & 0.888 & 0.87 & 0.873\\
\hline
down & HGSC & 0.888 & 0.882 & 0.868 & 0.871 & 0.856\\
\hline
down & LGSC & 0.941 & 0.958 & 0.922 & 0.935 & 0.92\\
\hline
down & MUC & 0.967 & 0.96 & 0.967 & 0.96 & 0.959\\
\hline
smote & CCOC & 0.944 & 0.941 & 0.933 & 0.939 & 0.931\\
\hline
smote & ENOC & 0.896 & 0.9 & 0.894 & 0.89 & 0.887\\
\hline
smote & HGSC & 0.92 & 0.901 & 0.911 & 0.913 & 0.901\\
\hline
smote & LGSC & 0.968 & 0.976 & 0.962 & 0.968 & 0.957\\
\hline
smote & MUC & 0.97 & 0.969 & 0.977 & 0.969 & \textbf{0.978}\\
\hline
\end{tabular}
\end{table}

\hypertarget{f1-score-2}{%
\subsection{F1-Score}\label{f1-score-2}}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/cs1-f1-1} 

}

\caption{CS1 Set F1-Score}\label{fig:cs1-f1}
\end{figure}

\begin{table}

\caption{\label{tab:cs1-f1-table}CS1 Set Macro-Averaged F1-Score by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
sampling & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & 0.748 & 0.805 & 0.794 & 0.718 & 0.771\\
\hline
up & 0.792 & 0.793 & \textbf{0.806} & 0.772 & 0.787\\
\hline
down & 0.76 & 0.771 & 0.751 & 0.733 & 0.723\\
\hline
smote & 0.804 & 0.797 & 0.803 & 0.797 & 0.784\\
\hline
\end{tabular}
\end{table}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/cs1-f1-class-1} 

}

\caption{CS1 Set Class-Specific F1-Score}\label{fig:cs1-f1-class}
\end{figure}

\begin{table}

\caption{\label{tab:cs1-f1-class-table}CS1 Set Class-Specific F1-Score by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l|l}
\hline
sampling & histotype & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & CCOC & 0.829 & 0.833 & 0.824 & 0.828 & 0.813\\
\hline
none & ENOC & 0.764 & 0.8 & 0.769 & 0.739 & 0.769\\
\hline
none & HGSC & 0.9 & 0.9 & 0.909 & 0.884 & 0.9\\
\hline
none & LGSC & 0.545 & 0.769 & 0.714 & 0.444 & 0.625\\
\hline
none & MUC & 0.727 & 0.727 & 0.8 & 0.667 & 0.769\\
\hline
up & CCOC & 0.839 & 0.813 & 0.812 & 0.828 & 0.784\\
\hline
up & ENOC & 0.78 & 0.782 & 0.766 & 0.765 & 0.743\\
\hline
up & HGSC & \textbf{0.915} & 0.898 & 0.909 & 0.903 & 0.902\\
\hline
up & LGSC & 0.667 & 0.8 & 0.769 & 0.667 & 0.727\\
\hline
up & MUC & 0.769 & 0.71 & 0.8 & 0.75 & 0.778\\
\hline
down & CCOC & 0.828 & 0.824 & 0.833 & 0.812 & 0.8\\
\hline
down & ENOC & 0.743 & 0.764 & 0.756 & 0.711 & 0.723\\
\hline
down & HGSC & 0.871 & 0.865 & 0.843 & 0.85 & 0.83\\
\hline
down & LGSC & 0.667 & 0.714 & 0.6 & 0.632 & 0.571\\
\hline
down & MUC & 0.727 & 0.727 & 0.732 & 0.714 & 0.706\\
\hline
smote & CCOC & 0.839 & 0.833 & 0.821 & 0.833 & 0.811\\
\hline
smote & ENOC & 0.779 & 0.785 & 0.769 & 0.766 & 0.757\\
\hline
smote & HGSC & \textbf{0.915} & 0.898 & 0.901 & 0.907 & 0.889\\
\hline
smote & LGSC & 0.75 & 0.769 & 0.75 & 0.75 & 0.706\\
\hline
smote & MUC & 0.769 & 0.727 & 0.8 & 0.766 & 0.8\\
\hline
\end{tabular}
\end{table}

\hypertarget{kappa-2}{%
\subsection{Kappa}\label{kappa-2}}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/cs1-kappa-1} 

}

\caption{CS1 Set Kappa}\label{fig:cs1-kappa}
\end{figure}

\begin{table}

\caption{\label{tab:cs1-kappa-table}CS1 Set Kappa by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
sampling & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & 0.743 & 0.776 & 0.765 & 0.706 & 0.752\\
\hline
up & 0.775 & 0.763 & 0.771 & 0.755 & 0.747\\
\hline
down & 0.723 & 0.733 & 0.707 & 0.694 & 0.675\\
\hline
smote & \textbf{0.777} & 0.768 & 0.767 & 0.766 & 0.746\\
\hline
\end{tabular}
\end{table}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/cs1-kappa-class-1} 

}

\caption{CS1 Set Class-Specific Kappa}\label{fig:cs1-kappa-class}
\end{figure}

\begin{table}

\caption{\label{tab:cs1-kappa-class-table}CS1 Set Class-Specific Kappa by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l|l}
\hline
sampling & histotype & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & CCOC & 0.795 & 0.797 & 0.784 & 0.792 & 0.777\\
\hline
none & ENOC & 0.691 & 0.744 & 0.704 & 0.666 & 0.7\\
\hline
none & HGSC & 0.803 & 0.806 & 0.824 & 0.764 & 0.807\\
\hline
none & LGSC & 0.49 & 0.754 & 0.692 & 0.342 & 0.593\\
\hline
none & MUC & 0.709 & 0.712 & 0.784 & 0.652 & 0.753\\
\hline
up & CCOC & 0.804 & 0.776 & 0.773 & 0.792 & 0.734\\
\hline
up & ENOC & 0.713 & 0.722 & 0.697 & 0.696 & 0.664\\
\hline
up & HGSC & 0.836 & 0.799 & 0.83 & 0.811 & 0.82\\
\hline
up & LGSC & 0.652 & 0.784 & 0.753 & 0.646 & 0.711\\
\hline
up & MUC & 0.753 & 0.678 & 0.782 & 0.73 & 0.757\\
\hline
down & CCOC & 0.789 & 0.784 & 0.797 & 0.774 & 0.755\\
\hline
down & ENOC & 0.664 & 0.691 & 0.679 & 0.624 & 0.643\\
\hline
down & HGSC & 0.772 & 0.76 & 0.731 & 0.738 & 0.706\\
\hline
down & LGSC & 0.632 & 0.691 & 0.558 & 0.594 & 0.523\\
\hline
down & MUC & 0.708 & 0.709 & 0.712 & 0.687 & 0.682\\
\hline
smote & CCOC & 0.804 & 0.796 & 0.776 & 0.794 & 0.767\\
\hline
smote & ENOC & 0.709 & 0.717 & 0.699 & 0.693 & 0.683\\
\hline
smote & HGSC & \textbf{0.84} & 0.802 & 0.819 & 0.825 & 0.799\\
\hline
smote & LGSC & 0.727 & 0.754 & 0.728 & 0.739 & 0.677\\
\hline
smote & MUC & 0.753 & 0.711 & 0.789 & 0.745 & 0.788\\
\hline
\end{tabular}
\end{table}

\hypertarget{g-mean-2}{%
\subsection{G-mean}\label{g-mean-2}}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/cs1-gmean-1} 

}

\caption{CS1 Set G-mean}\label{fig:cs1-gmean}
\end{figure}

\begin{table}

\caption{\label{tab:cs1-gmean-table}CS1 Set G-mean by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
sampling & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & 0.658 & 0.757 & 0.75 & 0.571 & 0.727\\
\hline
up & 0.734 & 0.734 & \textbf{0.812} & 0.716 & 0.787\\
\hline
down & 0.791 & 0.793 & 0.795 & 0.774 & 0.756\\
\hline
smote & 0.786 & 0.752 & 0.81 & 0.781 & 0.793\\
\hline
\end{tabular}
\end{table}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/cs1-gmean-class-1} 

}

\caption{CS1 Set Class-Specific G-mean}\label{fig:cs1-gmean-class}
\end{figure}

\begin{table}

\caption{\label{tab:cs1-gmean-class-table}CS1 Set Class-Specific G-mean by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l|l}
\hline
sampling & histotype & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & CCOC & 0.888 & 0.891 & 0.889 & 0.885 & 0.885\\
\hline
none & ENOC & 0.854 & 0.867 & 0.848 & 0.827 & 0.848\\
\hline
none & HGSC & 0.904 & 0.905 & 0.913 & 0.883 & 0.905\\
\hline
none & LGSC & 0.606 & 0.816 & 0.775 & 0.471 & 0.707\\
\hline
none & MUC & 0.775 & 0.812 & 0.845 & 0.745 & 0.84\\
\hline
up & CCOC & 0.893 & 0.883 & 0.891 & 0.888 & 0.87\\
\hline
up & ENOC & 0.864 & 0.848 & 0.846 & 0.849 & 0.833\\
\hline
up & HGSC & \textbf{0.92} & 0.902 & 0.914 & 0.908 & 0.909\\
\hline
up & LGSC & 0.707 & 0.816 & 0.913 & 0.707 & 0.889\\
\hline
up & MUC & 0.816 & 0.756 & 0.878 & 0.812 & 0.864\\
\hline
down & CCOC & 0.901 & 0.886 & 0.905 & 0.895 & 0.883\\
\hline
down & ENOC & 0.84 & 0.853 & 0.849 & 0.81 & 0.82\\
\hline
down & HGSC & 0.881 & 0.876 & 0.855 & 0.863 & 0.845\\
\hline
down & LGSC & 0.904 & 0.895 & 0.91 & 0.902 & 0.858\\
\hline
down & MUC & 0.856 & 0.895 & 0.859 & 0.861 & 0.852\\
\hline
smote & CCOC & 0.899 & 0.894 & 0.895 & 0.896 & 0.89\\
\hline
smote & ENOC & 0.872 & 0.868 & 0.854 & 0.856 & 0.846\\
\hline
smote & HGSC & \textbf{0.92} & 0.902 & 0.907 & 0.913 & 0.895\\
\hline
smote & LGSC & 0.835 & 0.816 & 0.898 & 0.84 & 0.863\\
\hline
smote & MUC & 0.856 & 0.788 & 0.882 & 0.848 & 0.877\\
\hline
\end{tabular}
\end{table}

\hypertarget{cs2-set}{%
\section{CS2 Set}\label{cs2-set}}

\hypertarget{accuracy-3}{%
\subsection{Accuracy}\label{accuracy-3}}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/cs2-accuracy-1} 

}

\caption{CS2 Set Accuracy}\label{fig:cs2-accuracy}
\end{figure}

\begin{table}

\caption{\label{tab:cs2-accuracy-table}CS2 Set Accuracy by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
sampling & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & 0.924 & 0.926 & \textbf{0.938} & 0.91 & 0.931\\
\hline
up & 0.926 & 0.926 & 0.922 & 0.931 & 0.921\\
\hline
down & 0.859 & 0.843 & 0.815 & 0.844 & 0.817\\
\hline
smote & 0.928 & 0.922 & 0.915 & 0.925 & 0.902\\
\hline
\end{tabular}
\end{table}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/cs2-accuracy-class-1} 

}

\caption{CS2 Set Class-Specific Accuracy}\label{fig:cs2-accuracy-class}
\end{figure}

\begin{table}

\caption{\label{tab:cs2-accuracy-class-table}CS2 Set Class-Specific Accuracy by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l|l}
\hline
sampling & histotype & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & CCOC & 0.984 & 0.981 & \textbf{0.987} & 0.983 & 0.983\\
\hline
none & ENOC & 0.974 & 0.981 & 0.98 & 0.967 & 0.977\\
\hline
none & HGSC & 0.931 & 0.936 & 0.949 & 0.913 & 0.946\\
\hline
none & LGSC & 0.977 & 0.977 & 0.977 & 0.976 & 0.975\\
\hline
none & MUC & 0.983 & 0.977 & 0.983 & 0.981 & 0.981\\
\hline
up & CCOC & 0.986 & 0.98 & 0.986 & 0.986 & 0.984\\
\hline
up & ENOC & 0.977 & 0.98 & 0.969 & 0.98 & 0.969\\
\hline
up & HGSC & 0.931 & 0.933 & 0.938 & 0.941 & 0.941\\
\hline
up & LGSC & 0.977 & 0.98 & 0.972 & 0.977 & 0.972\\
\hline
up & MUC & 0.981 & 0.977 & 0.98 & 0.981 & 0.979\\
\hline
down & CCOC & 0.98 & 0.956 & 0.977 & 0.979 & 0.97\\
\hline
down & ENOC & 0.96 & 0.958 & 0.954 & 0.959 & 0.943\\
\hline
down & HGSC & 0.879 & 0.867 & 0.842 & 0.866 & 0.844\\
\hline
down & LGSC & 0.948 & 0.954 & 0.921 & 0.939 & 0.922\\
\hline
down & MUC & 0.956 & 0.961 & 0.947 & 0.951 & 0.963\\
\hline
smote & CCOC & 0.984 & 0.979 & 0.986 & 0.984 & 0.981\\
\hline
smote & ENOC & 0.976 & 0.98 & 0.966 & 0.976 & 0.961\\
\hline
smote & HGSC & 0.943 & 0.934 & 0.933 & 0.941 & 0.923\\
\hline
smote & LGSC & 0.979 & 0.98 & 0.97 & 0.979 & 0.964\\
\hline
smote & MUC & 0.974 & 0.973 & 0.978 & 0.972 & 0.976\\
\hline
\end{tabular}
\end{table}

\hypertarget{f1-score-3}{%
\subsection{F1-Score}\label{f1-score-3}}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/cs2-f1-1} 

}

\caption{CS2 Set F1-Score}\label{fig:cs2-f1}
\end{figure}

\begin{table}

\caption{\label{tab:cs2-f1-table}CS2 Set Macro-Averaged F1-Score by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
sampling & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & 0.714 & 0.766 & 0.757 & 0.751 & 0.745\\
\hline
up & 0.722 & 0.755 & \textbf{0.784} & 0.741 & 0.761\\
\hline
down & 0.703 & 0.675 & 0.656 & 0.68 & 0.645\\
\hline
smote & 0.782 & 0.758 & 0.771 & 0.775 & 0.741\\
\hline
\end{tabular}
\end{table}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/cs2-f1-class-1} 

}

\caption{CS2 Set Class-Specific F1-Score}\label{fig:cs2-f1-class}
\end{figure}

\begin{table}

\caption{\label{tab:cs2-f1-class-table}CS2 Set Class-Specific F1-Score by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l|l}
\hline
sampling & histotype & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & CCOC & 0.889 & 0.857 & 0.903 & 0.875 & 0.884\\
\hline
none & ENOC & 0.471 & 0.706 & 0.667 & 0.267 & 0.632\\
\hline
none & HGSC & 0.958 & 0.961 & \textbf{0.968} & 0.948 & 0.966\\
\hline
none & LGSC & 0.222 & 0.5 & 0.375 & 0.286 & 0.4\\
\hline
none & MUC & 0.882 & 0.835 & 0.885 & 0.865 & 0.878\\
\hline
up & CCOC & 0.895 & 0.848 & 0.909 & 0.895 & 0.895\\
\hline
up & ENOC & 0.556 & 0.696 & 0.609 & 0.632 & 0.6\\
\hline
up & HGSC & 0.958 & 0.959 & 0.96 & 0.963 & 0.962\\
\hline
up & LGSC & 0.25 & 0.5 & 0.583 & 0.286 & 0.522\\
\hline
up & MUC & 0.87 & 0.833 & 0.864 & 0.87 & 0.857\\
\hline
down & CCOC & 0.87 & 0.755 & 0.844 & 0.857 & 0.809\\
\hline
down & ENOC & 0.556 & 0.538 & 0.5 & 0.533 & 0.444\\
\hline
down & HGSC & 0.919 & 0.909 & 0.89 & 0.909 & 0.893\\
\hline
down & LGSC & 0.432 & 0.452 & 0.343 & 0.389 & 0.333\\
\hline
down & MUC & 0.745 & 0.75 & 0.717 & 0.724 & 0.768\\
\hline
smote & CCOC & 0.895 & 0.842 & 0.9 & 0.895 & 0.872\\
\hline
smote & ENOC & 0.667 & 0.667 & 0.588 & 0.667 & 0.556\\
\hline
smote & HGSC & 0.963 & 0.959 & 0.957 & 0.963 & 0.95\\
\hline
smote & LGSC & 0.556 & 0.533 & 0.558 & 0.571 & 0.5\\
\hline
smote & MUC & 0.837 & 0.811 & 0.857 & 0.824 & 0.842\\
\hline
\end{tabular}
\end{table}

\hypertarget{kappa-3}{%
\subsection{Kappa}\label{kappa-3}}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/cs2-kappa-1} 

}

\caption{CS2 Set Kappa}\label{fig:cs2-kappa}
\end{figure}

\begin{table}

\caption{\label{tab:cs2-kappa-table}CS2 Set Kappa by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
sampling & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & 0.761 & 0.779 & \textbf{0.811} & 0.703 & 0.799\\
\hline
up & 0.764 & 0.767 & 0.798 & 0.794 & 0.789\\
\hline
down & 0.676 & 0.641 & 0.605 & 0.646 & 0.602\\
\hline
smote & 0.802 & 0.766 & 0.781 & 0.797 & 0.75\\
\hline
\end{tabular}
\end{table}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/cs2-kappa-class-1} 

}

\caption{CS2 Set Class-Specific Kappa}\label{fig:cs2-kappa-class}
\end{figure}

\begin{table}

\caption{\label{tab:cs2-kappa-class-table}CS2 Set Class-Specific Kappa by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l|l}
\hline
sampling & histotype & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & CCOC & 0.88 & 0.848 & 0.896 & 0.868 & 0.874\\
\hline
none & ENOC & 0.459 & 0.697 & 0.655 & 0.191 & 0.62\\
\hline
none & HGSC & 0.767 & 0.794 & 0.834 & 0.692 & 0.828\\
\hline
none & LGSC & 0.148 & 0.486 & 0.357 & 0 & 0.39\\
\hline
none & MUC & 0.873 & 0.823 & 0.875 & 0.856 & 0.869\\
\hline
up & CCOC & 0.888 & 0.839 & \textbf{0.902} & 0.888 & 0.885\\
\hline
up & ENOC & 0.544 & 0.684 & 0.594 & 0.622 & 0.586\\
\hline
up & HGSC & 0.764 & 0.775 & 0.823 & 0.806 & 0.823\\
\hline
up & LGSC & 0.214 & 0.486 & 0.568 & 0.264 & 0.506\\
\hline
up & MUC & 0.86 & 0.823 & 0.853 & 0.859 & 0.842\\
\hline
down & CCOC & 0.859 & 0.732 & 0.832 & 0.847 & 0.792\\
\hline
down & ENOC & 0.533 & 0.516 & 0.484 & 0.512 & 0.414\\
\hline
down & HGSC & 0.688 & 0.656 & 0.617 & 0.659 & 0.617\\
\hline
down & LGSC & 0.41 & 0.429 & 0.314 & 0.364 & 0.306\\
\hline
down & MUC & 0.722 & 0.729 & 0.687 & 0.696 & 0.747\\
\hline
smote & CCOC & 0.888 & 0.832 & 0.893 & 0.887 & 0.863\\
\hline
smote & ENOC & 0.655 & 0.655 & 0.568 & 0.651 & 0.54\\
\hline
smote & HGSC & 0.829 & 0.786 & 0.81 & 0.825 & 0.781\\
\hline
smote & LGSC & 0.542 & 0.523 & 0.544 & 0.561 & 0.484\\
\hline
smote & MUC & 0.824 & 0.797 & 0.845 & 0.808 & 0.831\\
\hline
\end{tabular}
\end{table}

\hypertarget{g-mean-3}{%
\subsection{G-mean}\label{g-mean-3}}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/cs2-gmean-1} 

}

\caption{CS2 Set G-mean}\label{fig:cs2-gmean}
\end{figure}

\begin{table}

\caption{\label{tab:cs2-gmean-table}CS2 Set G-mean by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
sampling & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & 0.363 & 0.693 & 0.649 & 0 & 0.657\\
\hline
up & 0.499 & 0.652 & \textbf{0.841} & 0.576 & 0.773\\
\hline
down & 0.829 & 0.802 & 0.808 & 0.811 & 0.792\\
\hline
smote & 0.775 & 0.685 & 0.835 & 0.763 & 0.806\\
\hline
\end{tabular}
\end{table}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/cs2-gmean-class-1} 

}

\caption{CS2 Set Class-Specific G-mean}\label{fig:cs2-gmean-class}
\end{figure}

\begin{table}

\caption{\label{tab:cs2-gmean-class-table}CS2 Set Class-Specific G-mean by Algorithm and Subsampling Method}
\centering
\begin{tabular}[t]{l|l|l|l|l|l|l}
\hline
sampling & histotype & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
none & CCOC & 0.913 & 0.891 & 0.933 & 0.889 & 0.928\\
\hline
none & ENOC & 0.576 & 0.78 & 0.739 & 0.333 & 0.742\\
\hline
none & HGSC & 0.83 & 0.866 & 0.889 & 0.773 & 0.894\\
\hline
none & LGSC & 0.301 & 0.698 & 0.535 & 0 & 0.574\\
\hline
none & MUC & 0.921 & 0.879 & 0.931 & 0.898 & 0.93\\
\hline
up & CCOC & 0.911 & 0.866 & \textbf{0.96} & 0.931 & 0.943\\
\hline
up & ENOC & 0.62 & 0.755 & 0.812 & 0.707 & 0.795\\
\hline
up & HGSC & 0.828 & 0.84 & 0.937 & 0.871 & 0.921\\
\hline
up & LGSC & 0.354 & 0.629 & 0.903 & 0.408 & 0.791\\
\hline
up & MUC & 0.911 & 0.87 & 0.941 & 0.934 & 0.92\\
\hline
down & CCOC & 0.958 & 0.936 & 0.928 & 0.947 & 0.918\\
\hline
down & ENOC & 0.827 & 0.827 & 0.807 & 0.803 & 0.795\\
\hline
down & HGSC & 0.904 & 0.888 & 0.881 & 0.893 & 0.878\\
\hline
down & LGSC & 0.896 & 0.887 & 0.887 & 0.885 & 0.883\\
\hline
down & MUC & 0.916 & 0.88 & 0.92 & 0.914 & 0.901\\
\hline
smote & CCOC & 0.957 & 0.885 & 0.957 & 0.954 & 0.942\\
\hline
smote & ENOC & 0.811 & 0.739 & 0.815 & 0.79 & 0.805\\
\hline
smote & HGSC & 0.922 & 0.861 & 0.932 & 0.92 & 0.921\\
\hline
smote & LGSC & 0.751 & 0.703 & 0.891 & 0.75 & 0.853\\
\hline
smote & MUC & 0.935 & 0.877 & 0.934 & 0.929 & 0.919\\
\hline
\end{tabular}
\end{table}

\hypertarget{smote-kappa-summary}{%
\section{SMOTE Kappa Summary}\label{smote-kappa-summary}}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/smote-kappa-1} 

}

\caption{SMOTE Kappa by Algorithm and Dataset}\label{fig:smote-kappa}
\end{figure}

\begin{table}

\caption{\label{tab:smote-kappa-table}SMOTE Kappa by Algorithm and Dataset}
\centering
\begin{tabular}[t]{l|l|l|l|l|l}
\hline
dataset & rf & svm & mlr\_ridge & adaboost & mlr\_lasso\\
\hline
Training & \textbf{0.843} & 0.816 & 0.782 & 0.821 & 0.769\\
\hline
CS1 & 0.777 & 0.768 & 0.767 & 0.766 & 0.746\\
\hline
CS2 & 0.802 & 0.766 & 0.781 & 0.797 & 0.75\\
\hline
\end{tabular}
\end{table}

\begin{figure}[H]

{\centering \includegraphics{OV_Histotypes_RSF_files/figure-latex/smote-kappa-class-1} 

}

\caption{SMOTE Class-Specific Kappa by Algorithm and Dataset}\label{fig:smote-kappa-class}
\end{figure}

\hypertarget{overlap-with-spot}{%
\section{Overlap with SPOT}\label{overlap-with-spot}}

There are 13 genes out of the 72 classifier set that overlap with the SPOT signature: HIF1A, CXCL10, DUSP4, SOX17, MITF, CDKN3, BRCA2, CEACAM5, ANXA4, SERPINE1, TCF7L1, CRABP2, DNAJC9.

\hypertarget{rank-aggregation}{%
\section{Rank Aggregation}\label{rank-aggregation}}

\begin{center}\includegraphics{OV_Histotypes_RSF_files/figure-latex/summary-1} \end{center}

The 44 methods (algorithm-sampling combinations) are ordered in the table by their aggregated ranks using the Genetic Algorithm. We see that the best performing methods involve the 2-stage and sequential algorithms.

\hypertarget{test-set-performance}{%
\section{Test Set Performance}\label{test-set-performance}}

Now we'd like to see how our best methods perform in the confirmation and validation sets. The class-specific F1-scores will be used.

The top 4 methods are:

\begin{itemize}
\tightlist
\item
  \textbf{2S-rf-none}: 2-step method using random forest algorithm with no subsampling
\item
  \textbf{sequential-up}: sequential algorithm with upsampling. The sequence of models and algorithms used are:

  \begin{itemize}
  \tightlist
  \item
    HGSC vs.~non-HGSC using adaboost
  \item
    MUC vs.~non-MUC using random forest
  \item
    CCOC vs.~non-CCOC using random forest
  \item
    ENOC vs.~LGSC using random forest
  \end{itemize}
\item
  \textbf{sequential-none}: sequential algorithm with no subsampling. The sequence of models and algorithms used are:

  \begin{itemize}
  \tightlist
  \item
    HGSC vs.~non-HGSC using SVM
  \item
    MUC vs.~non-MUC using ridge regression
  \item
    CCOC vs.~non-CCOC using random forest
  \item
    ENOC vs.~LGSC using SVM
  \end{itemize}
\item
  \textbf{sequential-down}: sequential algorithm with downsampling. The sequence of models and algorithms used are:

  \begin{itemize}
  \tightlist
  \item
    HGSC vs.~non-HGSC using random forest
  \item
    CCOC vs.~non-CCOC using random forest
  \item
    MUC vs.~non-MUC using ridge regression
  \item
    ENOC vs.~LGSC using random forest
  \end{itemize}
\end{itemize}

As a comparison we also show the F1-scores from the \textbf{rf-none} to see how the best methods improve from it.

\hypertarget{confirmation-set}{%
\subsection{Confirmation Set}\label{confirmation-set}}

\begin{table}

\caption{\label{tab:confirmation-set}Class-specific F1-scores on Confirmation Sets}
\centering
\begin{tabular}[t]{l|r|r|r|r|r}
\hline
method & HGSC & CCOC & ENOC & LGSC & MUC\\
\hline
2S-rf-none & 0.915 & 0.874 & 0.772 & 0.419 & 0.745\\
\hline
sequential-none & 0.902 & 0.910 & 0.917 & 0.485 & 0.711\\
\hline
2S-rf-smote & 0.903 & 0.904 & 0.784 & 0.400 & 0.667\\
\hline
sequential-smote & 0.907 & 0.923 & 0.921 & 0.556 & 0.800\\
\hline
rf-none & 0.899 & 0.881 & 0.533 & 0.133 & 0.760\\
\hline
\end{tabular}
\end{table}

In the confirmation set, \textbf{2S-rf-none} improves drastically in LGSC classification compard to \textbf{rf-none}, with moderate improvement in ENOC, and minor improvement in HGSC and CCOC. There is a decrease in MUC performance. \textbf{sequential-none} improves on \textbf{2S-rf-none} in all classes except for marginal decrease in HGSC performance.

\hypertarget{validation-set}{%
\subsection{Validation Set}\label{validation-set}}

\begin{table}

\caption{\label{tab:validation-set}Class-specific F1-scores on Validation Sets}
\centering
\begin{tabular}[t]{l|r|r|r|r|r}
\hline
method & HGSC & CCOC & ENOC & LGSC & MUC\\
\hline
2S-rf-none & 0.938 & 0.946 & 0.899 & 0.811 & 0.764\\
\hline
sequential-none & 0.948 & 0.963 & 0.963 & 0.789 & 0.784\\
\hline
2S-rf-smote & 0.933 & 0.940 & 0.882 & 0.750 & 0.778\\
\hline
sequential-smote & 0.940 & 0.951 & 0.967 & 0.821 & 0.821\\
\hline
rf-none & 0.929 & 0.857 & 0.630 & 0.182 & 0.727\\
\hline
\end{tabular}
\end{table}

Similarly in the validation set, \textbf{2S-rf-none} improves drastically in LGSC classification compared to \textbf{rf-none}, with large improvement in ENOC, and minor improvement in HGSC and CCOC. There is a decrease in MUC performance. \textbf{sequential-none} improves on \textbf{2S-rf-none} in all classes except for a small decrease in CCOC performance and same performance for LGSC.

  \bibliography{packages.bib}
\addcontentsline{toc}{chapter}{\bibname}

\end{document}
